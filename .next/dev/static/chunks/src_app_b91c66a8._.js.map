{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Michael/IdeaProjects/MSMTB/src/trading-cockpit/src/app/settings/mappings/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useState, useMemo } from 'react';\r\nimport { Save, RefreshCw, AlertTriangle, CheckCircle2, Search, ArrowLeft, BarChart3, Database, Wand2 } from 'lucide-react';\r\n\r\nimport { SymbolAutocomplete } from '@/components/ui/SymbolAutocomplete';\r\n\r\n// --- Types ---\r\n\r\ninterface MappingItem {\r\n    originalSymbol: string;\r\n    datafeedSymbol: string;\r\n    brokerMappings: Record<string, string>; // botId -> symbol\r\n}\r\n\r\ninterface BrokerInfo {\r\n    id: string;\r\n    name: string;\r\n    shorthand: string;\r\n}\r\n\r\n// --- Components ---\r\n\r\nconst IGNORE_SENTINEL = '__IGNORE__';\r\n\r\nconst BrokerCard = ({ broker, stats, onClick }: { broker: BrokerInfo, stats: { mapped: number, ignored: number, total: number }, onClick: () => void }) => {\r\n    const doneCount = stats.mapped + stats.ignored;\r\n    const percent = stats.total > 0 ? Math.round((doneCount / stats.total) * 100) : 0;\r\n    const isComplete = percent === 100;\r\n\r\n    return (\r\n        <div\r\n            onClick={onClick}\r\n            className={`bg-white dark:bg-slate-800 border rounded-xl p-5 cursor-pointer transition-all hover:shadow-lg group relative overflow-hidden\r\n                ${isComplete\r\n                    ? 'border-emerald-500/30 hover:border-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-950/10'\r\n                    : 'border-slate-300 dark:border-amber-500/30 hover:border-amber-500 hover:bg-slate-50 dark:hover:bg-slate-700'\r\n                }\r\n            `}\r\n        >\r\n            <div className=\"flex items-start justify-between mb-4 relative z-10\">\r\n                <div className={`p-3 rounded-lg border transition-colors ${isComplete ? 'bg-emerald-500/10 border-emerald-500/20 text-emerald-500 dark:text-emerald-400' : 'bg-slate-50 dark:bg-slate-900/50 border-slate-200 dark:border-slate-700/50 group-hover:border-blue-500/30 text-blue-500 dark:text-blue-400'}`}>\r\n                    <BarChart3 size={24} />\r\n                </div>\r\n                {isComplete && <CheckCircle2 className=\"text-emerald-500\" size={20} />}\r\n            </div>\r\n\r\n            <h3 className=\"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4 relative z-10\">{broker.name}</h3>\r\n\r\n            <div className=\"space-y-2 relative z-10\">\r\n                <div className=\"flex justify-between text-xs text-slate-500 dark:text-slate-400\">\r\n                    <span>Progress</span>\r\n                    <span className={isComplete ? \"text-emerald-500 dark:text-emerald-400 font-medium\" : \"text-amber-500 font-medium\"}>{doneCount} / {stats.total}</span>\r\n                </div>\r\n\r\n                {/* Multi-segment Progress Bar */}\r\n                <div className=\"h-2 w-full bg-slate-100 dark:bg-slate-900 rounded-full overflow-hidden flex\">\r\n                    {/* Mapped Segment */}\r\n                    <div\r\n                        className=\"h-full bg-blue-600 transition-all duration-500\"\r\n                        style={{ width: `${(stats.mapped / stats.total) * 100}%` }}\r\n                    />\r\n                    {/* Ignored Segment */}\r\n                    <div\r\n                        className=\"h-full bg-slate-300 dark:bg-slate-600 transition-all duration-500\"\r\n                        style={{ width: `${(stats.ignored / stats.total) * 100}%` }}\r\n                    />\r\n                </div>\r\n                <div className=\"flex justify-between text-[10px] text-slate-600 pt-1\">\r\n                    <span>{stats.mapped} Mapped</span>\r\n                    <span>{stats.ignored} Ignored</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\nconst DetailView = ({\r\n    broker,\r\n    onBack,\r\n    allMappings,\r\n    onChange,\r\n    onBulkChange, // New Prop\r\n    brokerSymbols\r\n}: {\r\n    broker: BrokerInfo,\r\n    onBack: () => void,\r\n    allMappings: MappingItem[],\r\n    onChange: (rowIndex: number, val: string) => void,\r\n    onBulkChange: (updates: { index: number, value: string }[]) => void, // New Prop Type\r\n    brokerSymbols: string[]\r\n}) => {\r\n    const [search, setSearch] = useState('');\r\n    const [page, setPage] = useState(1);\r\n    const [autoDetecting, setAutoDetecting] = useState(false); // UI Feedback\r\n    const ITEMS_PER_PAGE = 50;\r\n\r\n    // ... (Filter Logic)\r\n    const filteredIndices = useMemo(() => {\r\n        return allMappings.map((m, originalIndex) => ({ m, originalIndex }))\r\n            .filter(({ m }) => {\r\n                const term = search.toLowerCase();\r\n                if (!term) return true;\r\n                const matchOriginal = m.originalSymbol.toLowerCase().includes(term);\r\n                const currentVal = m.brokerMappings[broker.shorthand] || '';\r\n                const matchMapped = currentVal === IGNORE_SENTINEL ? 'not mapped' : currentVal.toLowerCase().includes(term);\r\n                return matchOriginal || matchMapped;\r\n            });\r\n    }, [allMappings, search, broker.shorthand]);\r\n\r\n    // Auto Detect Logic\r\n    const handleAutoDetect = () => {\r\n        setAutoDetecting(true);\r\n        const updates: { index: number, value: string }[] = [];\r\n        let count = 0;\r\n\r\n        allMappings.forEach((m, idx) => {\r\n            const currentVal = m.brokerMappings[broker.shorthand];\r\n            // Only fill if empty!\r\n            if (!currentVal) {\r\n                const searchName = m.originalSymbol.toLowerCase();\r\n                // Substring Search (Case Insensitive)\r\n                const match = brokerSymbols.find(s => s.toLowerCase().includes(searchName));\r\n\r\n                if (match) {\r\n                    updates.push({ index: idx, value: match });\r\n                    count++;\r\n                }\r\n            }\r\n        });\r\n\r\n        if (count > 0) {\r\n            onBulkChange(updates);\r\n        }\r\n        setAutoDetecting(false);\r\n    };\r\n\r\n    // Pagination Logic\r\n    const visibleItems = filteredIndices.slice(0, page * ITEMS_PER_PAGE);\r\n    const hasMore = visibleItems.length < filteredIndices.length;\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full animate-in fade-in slide-in-from-right-4 duration-300\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4 mb-6 pb-4 border-b border-slate-300 dark:border-slate-800\">\r\n                <button\r\n                    onClick={onBack}\r\n                    className=\"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white transition-colors\"\r\n                >\r\n                    <ArrowLeft size={20} />\r\n                </button>\r\n                <div>\r\n                    <h2 className=\"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2\">\r\n                        {broker.name} <span className=\"text-slate-400 dark:text-slate-500 text-sm font-normal\">Mapping Config</span>\r\n                    </h2>\r\n                </div>\r\n\r\n                <div className=\"ml-auto flex items-center gap-3\">\r\n                    <button\r\n                        onClick={handleAutoDetect}\r\n                        disabled={autoDetecting}\r\n                        className=\"flex items-center gap-2 px-3 py-1.5 bg-indigo-600/20 hover:bg-indigo-600/40 text-indigo-400 border border-indigo-500/30 rounded-lg text-sm transition-all\"\r\n                        title=\"Auto-fill empty fields based on name match\"\r\n                    >\r\n                        <Wand2 size={14} />\r\n                        Auto Detect\r\n                    </button>\r\n\r\n                    <div className=\"relative w-64\">\r\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500\" size={14} />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Filter symbols...\"\r\n                            value={search}\r\n                            onChange={(e) => { setSearch(e.target.value); setPage(1); }}\r\n                            className=\"w-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-700 rounded-lg pl-9 pr-3 py-1.5 text-sm text-slate-900 dark:text-slate-200 focus:outline-none focus:border-blue-500 transition-colors\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Simple Table */}\r\n            {/* ... (Rest of table remains same) */}\r\n            <div className=\"flex-1 overflow-y-auto custom-scrollbar bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-800 rounded-xl relative\">\r\n                <div className=\"absolute inset-0 overflow-auto\">\r\n                    <table className=\"w-full text-left border-collapse\">\r\n                        <thead className=\"bg-slate-50 dark:bg-slate-950 text-slate-500 dark:text-slate-400 text-xs uppercase font-bold sticky top-0 z-10 shadow-sm border-b border-slate-300 dark:border-slate-800\">\r\n                            <tr>\r\n                                <th className=\"p-4 border-b border-slate-800 w-1/3\">Original Symbol</th>\r\n                                <th className=\"p-4 border-b border-slate-800\">\r\n                                    Mapped To ({broker.shorthand})\r\n                                </th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-slate-100 dark:divide-slate-800/50\">\r\n                            {visibleItems.map(({ m, originalIndex }) => {\r\n                                const currentVal = m.brokerMappings[broker.shorthand] || '';\r\n                                const isIgnored = currentVal === IGNORE_SENTINEL;\r\n\r\n                                return (\r\n                                    <tr key={m.originalSymbol} className={`hover:bg-slate-50 dark:hover:bg-slate-800/30 transition-colors ${isIgnored ? 'opacity-60 bg-slate-50 dark:bg-slate-950/30' : ''}`}>\r\n                                        <td className=\"p-3 pl-4\">\r\n                                            <div className={`font-mono font-bold ${isIgnored ? 'text-slate-400 dark:text-slate-500 line-through decoration-slate-400 dark:decoration-slate-600' : 'text-slate-900 dark:text-slate-200'}`}>{m.originalSymbol}</div>\r\n                                            <div className=\"text-[10px] text-slate-500\">{m.datafeedSymbol.split(':')[0]}</div>\r\n                                        </td>\r\n                                        <td className=\"p-2\">\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                {!isIgnored ? (\r\n                                                    <SymbolAutocomplete\r\n                                                        value={currentVal}\r\n                                                        onChange={(v) => onChange(originalIndex, v)}\r\n                                                        brokerId={broker.shorthand}\r\n                                                        items={brokerSymbols}\r\n                                                        placeholder={`Symbol for ${broker.shorthand}...`}\r\n                                                        className=\"bg-white dark:bg-slate-950/50 border-slate-200 dark:border-slate-700/50 focus:border-blue-500/50 w-full h-9 text-sm font-mono flex-1 text-slate-900 dark:text-slate-200 placeholder:text-slate-400 dark:placeholder:text-slate-600\"\r\n                                                    />\r\n                                                ) : (\r\n                                                    <div className=\"flex-1 h-9 flex items-center px-3 text-xs text-slate-400 dark:text-slate-500 border border-dashed border-slate-300 dark:border-slate-700 rounded bg-slate-50 dark:bg-slate-900/50 cursor-not-allowed\">\r\n                                                        Not Mapped (Ignored)\r\n                                                    </div>\r\n                                                )}\r\n\r\n                                                <button\r\n                                                    onClick={() => onChange(originalIndex, isIgnored ? '' : IGNORE_SENTINEL)}\r\n                                                    className={`p-2 rounded-lg border transition-all ${isIgnored\r\n                                                        ? 'bg-slate-100 dark:bg-slate-800 border-slate-200 dark:border-slate-600 text-slate-500 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700'\r\n                                                        : 'bg-transparent border-transparent text-slate-400 dark:text-slate-600 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-950/20'\r\n                                                        }`}\r\n                                                    title={isIgnored ? \"Enable Mapping\" : \"Mark as Not Mapped\"}\r\n                                                >\r\n                                                    {isIgnored ? <RefreshCw size={14} /> : <AlertTriangle size={14} />}\r\n                                                </button>\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                );\r\n                            })}\r\n\r\n                            {visibleItems.length === 0 && (\r\n                                <tr>\r\n                                    <td colSpan={2} className=\"p-8 text-center text-slate-500 italic\">\r\n                                        No symbols match your filter.\r\n                                    </td>\r\n                                </tr>\r\n                            )}\r\n                        </tbody>\r\n                    </table>\r\n\r\n                    {/* Load More Trigger */}\r\n                    {hasMore && (\r\n                        <div className=\"p-4 text-center border-t border-slate-800/50\">\r\n                            <button\r\n                                onClick={() => setPage(p => p + 1)}\r\n                                className=\"text-xs text-blue-400 hover:text-blue-300 font-medium px-4 py-2 hover:bg-slate-800/50 rounded-lg transition-colors\"\r\n                            >\r\n                                Load 50 More...\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// --- Main Page ---\r\n\r\nexport default function AssetMappingsPage({ onUpdate }: { onUpdate?: () => void }) {\r\n    const [loading, setLoading] = useState(true);\r\n    const [saving, setSaving] = useState(false);\r\n    const [statusMsg, setStatusMsg] = useState<{ type: 'success' | 'error', text: string } | null>(null);\r\n\r\n    const [mappings, setMappings] = useState<MappingItem[]>([]);\r\n    const [initialMappings, setInitialMappings] = useState<MappingItem[]>([]); // For dirty checking\r\n    const [brokers, setBrokers] = useState<BrokerInfo[]>([]);\r\n    const [brokerSymbolsCache, setBrokerSymbolsCache] = useState<Record<string, string[]>>({});\r\n\r\n    const [selectedBroker, setSelectedBroker] = useState<BrokerInfo | null>(null);\r\n\r\n    // Initial Load\r\n    useEffect(() => {\r\n        const load = async () => {\r\n            try {\r\n                // 1. Load Brokers\r\n                const brokersRes = await fetch('/api/brokers');\r\n                const brokersData = await brokersRes.json();\r\n                setBrokers(brokersData);\r\n\r\n                // 2. Load Mappings\r\n                const mapRes = await fetch('/api/mappings');\r\n                const mapData = await mapRes.json();\r\n\r\n                setMappings(mapData || []);\r\n                setInitialMappings(JSON.parse(JSON.stringify(mapData || []))); // Deep copy for initial state\r\n            } catch (e) {\r\n                console.error(\"Failed to load data\", e);\r\n                setStatusMsg({ type: 'error', text: \"Failed to load configuration.\" });\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n        load();\r\n    }, []);\r\n\r\n    // Lazy Load Symbols when entering Detail View\r\n    useEffect(() => {\r\n        if (selectedBroker && !brokerSymbolsCache[selectedBroker.shorthand]) {\r\n            const fetchSymbols = async () => {\r\n                try {\r\n                    const symRes = await fetch(`/api/broker-symbols/${selectedBroker.shorthand}`);\r\n                    const symList = await symRes.json();\r\n                    const cleanList = symList.map((s: string | { name: string }) => typeof s === 'string' ? s : s.name);\r\n\r\n                    setBrokerSymbolsCache(prev => ({\r\n                        ...prev,\r\n                        [selectedBroker.shorthand]: cleanList\r\n                    }));\r\n                } catch (e) {\r\n                    console.warn(`Failed to lazy load symbols for ${selectedBroker.shorthand}`, e);\r\n                }\r\n            };\r\n            fetchSymbols();\r\n        }\r\n    }, [selectedBroker]);\r\n\r\n    // Dirty Checking\r\n    const hasChanges = useMemo(() => {\r\n        return JSON.stringify(mappings) !== JSON.stringify(initialMappings);\r\n    }, [mappings, initialMappings]);\r\n\r\n    // Change Handler\r\n    const handleCellChange = (rowIndex: number, brokerId: string, val: string) => {\r\n        setMappings(prev => {\r\n            const next = [...prev];\r\n            // Shallow Copy Row\r\n            const row = { ...next[rowIndex] };\r\n            // Shallow Copy Internal Map\r\n            row.brokerMappings = { ...row.brokerMappings, [brokerId]: val };\r\n            next[rowIndex] = row;\r\n            return next;\r\n        });\r\n    };\r\n\r\n    // Bulk Change Handler\r\n    const handleBulkChange = (updates: { index: number, value: string }[]) => {\r\n        if (!selectedBroker) return;\r\n        setMappings(prev => {\r\n            const next = [...prev];\r\n            updates.forEach(u => {\r\n                const row = { ...next[u.index] };\r\n                row.brokerMappings = { ...row.brokerMappings, [selectedBroker.shorthand]: u.value };\r\n                next[u.index] = row;\r\n            });\r\n            return next;\r\n        });\r\n    };\r\n\r\n    // Save Handler\r\n    const handleSave = async () => {\r\n        setSaving(true);\r\n        try {\r\n            // Optimization: Only send modified? API usually expects full item or we send all.\r\n            // Keeping consistent with previous logic: Send all mappings.\r\n            await Promise.all(mappings.map(async m => {\r\n                const res = await fetch('/api/mappings', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify(m)\r\n                });\r\n                if (!res.ok) {\r\n                    const err = await res.json();\r\n                    throw new Error(`Save failed for ${m.originalSymbol}: ${err.error || 'Unknown Error'}`);\r\n                }\r\n            }));\r\n\r\n            setInitialMappings(JSON.parse(JSON.stringify(mappings))); // Update baseline\r\n            setStatusMsg({ type: 'success', text: \"All mappings saved successfully!\" });\r\n            onUpdate?.(); // Notify parent to refresh badge\r\n            setTimeout(() => setStatusMsg(null), 3000);\r\n        } catch (e) {\r\n            console.error(e);\r\n            setStatusMsg({ type: 'error', text: \"Failed to save mappings.\" });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return <div className=\"p-10 text-center text-slate-500 animate-pulse\"><RefreshCw className=\"animate-spin inline mr-2\" /> Loading Configuration...</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"h-full flex flex-col p-6 animate-in fade-in zoom-in-95 duration-300\">\r\n            {/* Top Bar (Only show global save if on dashboard/stats or consistently? Consistently is better) */}\r\n            <header className=\"mb-6 flex justify-between items-center flex-shrink-0\">\r\n                <div>\r\n                    {!selectedBroker ? (\r\n                        <>\r\n                            <h2 className=\"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-2\">\r\n                                <Database className=\"text-blue-600 dark:text-blue-500\" size={24} />\r\n                                Symbol Mappings\r\n                            </h2>\r\n                            <p className=\"text-slate-500 mt-1 text-sm\">Select a broker to configure symbol mappings.</p>\r\n                        </>\r\n                    ) : (\r\n                        // Detail View Header handled in DetailView component\r\n                        <span />\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-3\">\r\n                    <button\r\n                        onClick={handleSave}\r\n                        disabled={saving || !hasChanges}\r\n                        className={`flex items-center gap-2 px-6 py-2 font-bold rounded-lg shadow-lg transition-all \r\n                            ${hasChanges\r\n                                ? 'bg-amber-500 hover:bg-amber-400 text-white shadow-amber-500/20 scale-105'\r\n                                : 'bg-slate-700 text-slate-400 cursor-not-allowed opacity-50'\r\n                            }\r\n                        `}\r\n                    >\r\n                        {saving ? <RefreshCw className=\"animate-spin\" size={18} /> : <Save size={18} />}\r\n                        {saving ? 'Saving...' : (hasChanges ? 'Save *' : 'No Changes')}\r\n                    </button>\r\n                </div>\r\n            </header>\r\n\r\n            {statusMsg && (\r\n                <div className={`mb-6 p-4 rounded-xl flex items-center gap-3 shadow-md ${statusMsg.type === 'success' ? 'bg-emerald-950/40 text-emerald-400 border border-emerald-500/20' : 'bg-red-950/40 text-red-400 border border-red-500/20'}`}>\r\n                    {statusMsg.type === 'success' ? <CheckCircle2 size={20} /> : <AlertTriangle size={20} />}\r\n                    <span className=\"font-medium\">{statusMsg.text}</span>\r\n                </div>\r\n            )}\r\n\r\n            {/* Content Area */}\r\n            <div className=\"flex-1 min-h-0\">\r\n                {!selectedBroker ? (\r\n                    /* Dashboard Grid */\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n                        {brokers.map(broker => {\r\n                            // Calculate stats\r\n                            const total = mappings.length;\r\n                            const mapped = mappings.filter(m => {\r\n                                const val = m.brokerMappings[broker.shorthand];\r\n                                return !!val && val !== IGNORE_SENTINEL;\r\n                            }).length;\r\n                            const ignored = mappings.filter(m => m.brokerMappings[broker.shorthand] === IGNORE_SENTINEL).length;\r\n\r\n                            return (\r\n                                <BrokerCard\r\n                                    key={broker.id}\r\n                                    broker={broker}\r\n                                    stats={{ mapped, ignored, total }}\r\n                                    onClick={() => setSelectedBroker(broker)}\r\n                                />\r\n                            );\r\n                        })}\r\n                    </div>\r\n                ) : (\r\n                    /* Detail View */\r\n                    <DetailView\r\n                        broker={selectedBroker}\r\n                        onBack={() => setSelectedBroker(null)}\r\n                        allMappings={mappings}\r\n                        onChange={(idx, val) => handleCellChange(idx, selectedBroker.shorthand, val)}\r\n                        onBulkChange={handleBulkChange}\r\n                        brokerSymbols={brokerSymbolsCache[selectedBroker.shorthand] || []}\r\n                    />\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 911, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Michael/IdeaProjects/MSMTB/src/trading-cockpit/src/app/data-history/page.tsx"],"sourcesContent":["import { DataHistoryView } from \"@/components/data-history/DataHistoryView\";\r\n\r\nexport default function DataHistoryPage() {\r\n    return <DataHistoryView />;\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;;AAEe,SAAS;IACpB,qBAAO,6LAAC,8KAAe;;;;;AAC3B;KAFwB"}},
    {"offset": {"line": 936, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Michael/IdeaProjects/MSMTB/src/trading-cockpit/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { fetchMessages, sendCommand } from \"../services/api\";\nimport { Message } from \"../types\";\nimport { ChartContainer } from \"../components/charts/ChartContainer\";\nimport { MessageCard } from \"../components/MessageCard\";\nimport LiveChartPage from \"../components/live/LiveChartPage\";\nimport { ChartThemeProvider } from '../context/ChartThemeContext';\nimport { SystemView } from \"../components/dashboard/SystemView\";\nimport { SettingsView } from \"../components/dashboard/SettingsView\";\nimport { AccountsView } from \"../components/dashboard/AccountsView\";\nimport { DatafeedView } from \"../components/dashboard/DatafeedView\";\nimport { DistributionView } from \"../components/dashboard/DistributionView\";\nimport { Activity, LayoutDashboard, Users, Settings, FlaskConical, BarChart3, Radio, ChevronLeft, ChevronRight, Maximize2, LineChart, Database, FileJson, Share2, History, Cpu } from \"lucide-react\";\nimport AssetMappingPage from \"./settings/mappings/page\";\nimport DataHistoryPage from \"./data-history/page\";\n\n// SIMPLE UTILS\nconst cn = (...classes: (string | undefined | null | boolean)[]) => classes.filter(Boolean).join(\" \");\n\n// --- MOCK CHART DATA ---\nconst generateDummyCandles = (count: number, startPrice: number) => {\n  const data = [];\n  let baseTime = Math.floor(Date.now() / 1000) - count * 300; // 5 min candles\n  let basePrice = startPrice;\n  for (let i = 0; i < count; i++) {\n    const open = basePrice + (Math.random() - 0.5) * 0.0010;\n    const close = open + (Math.random() - 0.5) * 0.0010;\n    const high = Math.max(open, close) + Math.random() * 0.0005;\n    const low = Math.min(open, close) - Math.random() * 0.0005;\n    data.push({\n      time: baseTime + i * 300,\n      open, high, low, close\n    });\n    basePrice = close;\n  }\n  return data;\n};\n\n// --- VIEWS ENUM ---\ntype ViewType = 'DASHBOARD' | 'LIVE_COCKPIT' | 'LIVE_CHART' | 'ACCOUNTS' | 'SETTINGS' | 'STRATEGY_LAB' | 'DATAFEED' | 'ASSET_MAPPINGS' | 'DISTRIBUTION' | 'DATA_HISTORY' | 'SYSTEM';\n\nexport default function Dashboard() {\n  const [messages, setMessages] = useState<Message[]>([]);\n\n  // PERSISTENCE: Recover lastTimestamp to avoid refetching history\n  const [lastTimestamp, setLastTimestamp] = useState(() => {\n    if (typeof window !== 'undefined') {\n      const saved = localStorage.getItem('lastMsgTimestamp');\n      return saved ? parseInt(saved) : 0;\n    }\n    return 0;\n  });\n\n  useEffect(() => {\n    if (lastTimestamp > 0) {\n      localStorage.setItem('lastMsgTimestamp', lastTimestamp.toString());\n    }\n  }, [lastTimestamp]);\n  const [activeView, setActiveView] = useState<ViewType>('DASHBOARD');\n  const [isFeedCollapsed, setIsFeedCollapsed] = useState(false);\n  const [isLiveFeedCollapsed, setIsLiveFeedCollapsed] = useState(false);\n  const [selectedSetupId, setSelectedSetupId] = useState<string | null>(null);\n  const [isLoadingHistory, setIsLoadingHistory] = useState(false);\n  const [timeframe, setTimeframe] = useState(\"H4\");\n  const [isSidebarHovered, setIsSidebarHovered] = useState(false);\n\n  // Chart State\n  const [dataA, setDataA] = useState(generateDummyCandles(100, 1.0500)); // EURUSD\n  const [dataB, setDataB] = useState(generateDummyCandles(100, 1.2500)); // GBPUSD\n\n  // --- DATA FETCHING ---\n  useEffect(() => {\n    const interval = setInterval(async () => {\n      const newMessages = await fetchMessages(lastTimestamp);\n      if (newMessages.length > 0) {\n        setMessages(prev => {\n          // Deduplicate by ID just in case\n          const existingIds = new Set(prev.map(m => m.id));\n          const uniqueNew = newMessages.filter(m => !existingIds.has(m.id));\n\n          // Check for HISTORY_DATA response\n          uniqueNew.forEach(msg => {\n            if (msg.type === 'HISTORY_DATA' && msg.content && (msg.content as any).candles) {\n              console.log(\"Applying History Data to Chart:\", msg.symbol);\n              const rawCandles = (msg.content as any).candles;\n              const cleanData = rawCandles.map((c: any) => ({\n                time: c.time,\n                open: c.open,\n                high: c.high,\n                low: c.low,\n                close: c.close\n              }));\n\n              setDataA(cleanData);\n              setIsLoadingHistory(false);\n            }\n          });\n\n          return [...prev, ...uniqueNew];\n        });\n        setLastTimestamp(newMessages[newMessages.length - 1].timestamp);\n      }\n    }, 1000); // Faster polling\n    return () => clearInterval(interval);\n  }, [lastTimestamp]);\n\n  // --- HANDLERS ---\n  const handleSetupClick = async (msg: Message) => {\n    setSelectedSetupId(msg.id);\n    setIsLoadingHistory(true);\n    setDataA([]); // Clear old data\n    setDataB([]);\n\n    const command = {\n      type: \"CMD_FETCH_HISTORY\",\n      symbol: msg.symbol || \"EURUSD\",\n      timeframe: \"PERIOD_H4\",\n      start: Math.floor(msg.timestamp / 1000),\n      count: 500\n    };\n\n    console.log(\"Triggering Bot Fetch:\", command);\n    const success = await sendCommand(command);\n    if (!success) {\n      setIsLoadingHistory(false);\n    }\n  };\n\n  // --- FILTERING ---\n  const liveMessages = messages.filter(m => !m.environment || m.environment === 'LIVE');\n  const backtestMessages = messages.filter(m => m.environment === 'BACKTEST');\n\n  // --- SIDEBAR BADGE LOGIC ---\n  const [hasPendingMappings, setHasPendingMappings] = useState(false);\n\n  const checkMappings = async () => {\n    try {\n      const [brokersRes, mappingsRes] = await Promise.all([\n        fetch('/api/brokers'),\n        fetch('/api/mappings')\n      ]);\n\n      if (brokersRes.ok && mappingsRes.ok) {\n        const brokers: any[] = await brokersRes.json();\n        const mappings: any[] = await mappingsRes.json();\n        const IGNORE_SENTINEL = '__IGNORE__';\n\n        let pending = false;\n        for (const m of mappings) {\n          for (const b of brokers) {\n            const val = m.brokerMappings[b.shorthand];\n            // Pending if:\n            // 1. Value is missing (undefined/null)\n            // 2. Value is empty string\n            // 3. AND Value is NOT the ignore sentinel\n            if (!val || (val !== IGNORE_SENTINEL && val.trim() === '')) {\n              pending = true;\n              break;\n            }\n          }\n          if (pending) break;\n        }\n        setHasPendingMappings(pending);\n      }\n    } catch (e) {\n      console.error(\"Failed to check mapping status\", e);\n    }\n  };\n\n  useEffect(() => {\n    // Initial check\n    checkMappings();\n\n    // Poll every 5 seconds to update badge when user fixes mappings\n    const interval = setInterval(checkMappings, 5000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const SidebarItem = ({ id, icon: Icon, label, section, badge }: { id: ViewType, icon: any, label: string, section?: boolean, badge?: boolean }) => (\n    <button\n      onClick={() => setActiveView(id)}\n      className={cn(\n        \"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200 group relative overflow-hidden\",\n        activeView === id\n          ? \"bg-indigo-500/10 text-indigo-600 dark:text-indigo-400 border border-indigo-500/20 shadow-lg shadow-indigo-500/10\"\n          : \"text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-slate-200\"\n      )}\n    >\n      <Icon size={20} className={cn(\"shrink-0 transition-colors\", activeView === id ? \"text-indigo-600 dark:text-indigo-400\" : \"text-slate-400 dark:text-slate-500 group-hover:text-slate-600 dark:group-hover:text-slate-300\")} />\n      <span className={cn(\n        \"text-sm font-medium whitespace-nowrap transition-opacity duration-300 delay-75 absolute left-12\",\n        isSidebarHovered ? \"opacity-100\" : \"opacity-0\"\n      )}>{label}</span>\n\n      {/* Badge */}\n      {badge && (\n        <div className={`absolute right-2 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-amber-500 shadow-[0_0_8px_rgba(245,158,11,0.8)] transition-opacity duration-300 ${isSidebarHovered ? 'opacity-100' : 'opacity-100'}`} />\n      )}\n\n      {activeView === id && (\n        <div className={cn(\n          \"ml-auto w-1.5 h-1.5 rounded-full bg-indigo-400 shadow-[0_0_8px_rgba(129,140,248,0.8)] transition-opacity delay-100\",\n          isSidebarHovered ? \"opacity-100\" : \"opacity-0\"\n        )} />\n      )}\n    </button>\n  );\n\n  return (\n    <ChartThemeProvider>\n      <div className=\"flex h-screen bg-slate-100 dark:bg-slate-950 text-slate-900 dark:text-slate-200 font-sans selection:bg-indigo-500/30 overflow-hidden\">\n        {/* ... (rest of sidebar) ... */}\n        <aside\n          className={cn(\n            \"bg-white dark:bg-slate-900 border-r border-slate-300 dark:border-slate-800 flex flex-col z-20 shrink-0 transition-all duration-300 ease-in-out group overflow-hidden\",\n            activeView === 'LIVE_CHART' && !isSidebarHovered ? \"p-0\" : \"p-3\", // Remove padding when deeply collapsed\n            activeView === 'DASHBOARD' ? \"w-16 hover:w-64\" : \"w-16 hover:w-64\"\n          )}\n          style={{ width: isSidebarHovered ? '16rem' : (activeView === 'LIVE_CHART' ? '0.5rem' : '4rem') }}\n          onMouseEnter={() => setIsSidebarHovered(true)}\n          onMouseLeave={() => setIsSidebarHovered(false)}\n        >\n          {/* Inner Content Wrapper to handle opacity during deep collapse */}\n          <div className={cn(\n            \"flex flex-col flex-1 overflow-hidden transition-opacity duration-200\",\n            activeView === 'LIVE_CHART' && !isSidebarHovered ? \"opacity-0 invisible\" : \"opacity-100 visible\"\n          )}>\n            {/* ... Logo ... */}\n            <div className=\"mb-8 flex items-center gap-3 overflow-hidden whitespace-nowrap\">\n              <div className=\"w-10 h-10 shrink-0 rounded-lg bg-gradient-to-br from-indigo-500 to-cyan-500 flex items-center justify-center shadow-lg shadow-indigo-500/20\">\n                <LayoutDashboard size={20} className=\"text-white\" />\n              </div>\n              <div className={`transition-opacity duration-300 delay-100 flex flex-col justify-center ${isSidebarHovered ? 'opacity-100' : 'opacity-0'}`}>\n                <h1 className=\"font-bold text-lg tracking-tight text-slate-900 dark:text-white leading-tight\">Awesome Cockpit</h1>\n                <p className=\"text-[10px] text-slate-500 uppercase tracking-wider font-semibold\">Terminal v2.0</p>\n              </div>\n            </div>\n\n            <div className=\"space-y-6 overflow-hidden\">\n              <div className=\"space-y-1\">\n                <SidebarItem id=\"DASHBOARD\" icon={LayoutDashboard} label=\"Dashboard\" />\n              </div>\n\n              <div>\n                <p className={`px-3 text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-2 transition-opacity whitespace-nowrap delay-75 ${isSidebarHovered ? 'opacity-100' : 'opacity-0'}`}>Settings</p>\n                <SidebarItem id=\"SYSTEM\" icon={Cpu} label=\"System\" />\n              </div>\n            </div>\n\n            <div>\n              <p className={`px-3 text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-2 transition-opacity whitespace-nowrap delay-75 ${isSidebarHovered ? 'opacity-100' : 'opacity-0'}`}>Environment</p>\n              <div className=\"space-y-1\">\n                <SidebarItem id=\"ACCOUNTS\" icon={Users} label=\"Accounts\" />\n                <SidebarItem id=\"SETTINGS\" icon={Settings} label=\"Brokers\" />\n                <SidebarItem id=\"DATAFEED\" icon={Database} label=\"Datafeeds & Symbols\" />\n                <SidebarItem id=\"ASSET_MAPPINGS\" icon={FileJson} label=\"Symbol Mappings\" badge={hasPendingMappings} />\n                <SidebarItem id=\"DATA_HISTORY\" icon={History} label=\"Data History\" />\n              </div>\n            </div>\n\n            <div>\n              <p className={`px-3 text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-2 transition-opacity whitespace-nowrap delay-75 ${isSidebarHovered ? 'opacity-100' : 'opacity-0'}`}>Trading</p>\n              <div className=\"space-y-1\">\n                <SidebarItem id=\"LIVE_CHART\" icon={LineChart} label=\"Live Chart\" />\n                <SidebarItem id=\"DISTRIBUTION\" icon={Share2} label=\"Distribution\" />\n              </div>\n            </div>\n          </div>\n\n          {/* ... Connection Status ... */}\n          <div className=\"p-2 bg-slate-100 dark:bg-slate-950 rounded-lg border border-slate-200 dark:border-slate-800 flex items-center gap-3 overflow-hidden whitespace-nowrap\">\n            <div className=\"relative shrink-0\">\n              <div className=\"w-2.5 h-2.5 rounded-full bg-emerald-500\" />\n              <div className=\"absolute inset-0 w-2.5 h-2.5 rounded-full bg-emerald-500 animate-ping opacity-50\" />\n            </div>\n            <div className={`flex-1 transition-opacity duration-300 delay-100 ${isSidebarHovered ? 'opacity-100' : 'opacity-0'}`}>\n              <div className=\"text-xs font-medium text-slate-600 dark:text-slate-300\">System Online</div>\n              <div className=\"text-[10px] text-slate-500\">Hub Latency: 4ms</div>\n            </div>\n          </div>\n        </aside>\n\n        {/* --- MAIN CONTENT AREA --- */}\n        <main className=\"flex-1 overflow-hidden relative flex flex-col\">\n          {/* Background Elements */}\n          <div className=\"absolute top-0 right-0 w-[500px] h-[500px] bg-indigo-500/5 rounded-full blur-3xl pointer-events-none\" />\n          <div className=\"absolute bottom-0 left-0 w-[500px] h-[500px] bg-cyan-500/5 rounded-full blur-3xl pointer-events-none\" />\n\n          {/* --- VIEW: DASHBOARD (Welcome) --- */}\n          {activeView === 'DASHBOARD' && (\n            <div className=\"h-full flex flex-col items-center justify-center p-6 animate-in fade-in zoom-in-95 duration-500\">\n              <div className=\"text-center max-w-2xl space-y-8\">\n                <div className=\"inline-flex p-6 bg-slate-900 rounded-3xl border border-slate-800 shadow-2xl shadow-indigo-500/10 mb-4\">\n                  <LayoutDashboard size={64} className=\"text-indigo-500\" />\n                </div>\n\n                <div>\n                  <h1 className=\"text-4xl font-bold text-slate-900 dark:text-white mb-4\">Welcome to Awesome Cockpit</h1>\n                  <p className=\"text-slate-500 dark:text-slate-400 text-lg\">\n                    Centralized control for your algorithmic trading infrastructure.\n                    Select a module from the sidebar to begin.\n                  </p>\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-left\">\n                  <button onClick={() => setActiveView('LIVE_CHART')} className=\"p-4 bg-white dark:bg-slate-900/50 border border-slate-300 dark:border-slate-800 hover:border-indigo-500/50 hover:bg-white dark:hover:bg-slate-800 rounded-xl transition-all group shadow-sm\">\n                    <h3 className=\"font-bold text-slate-900 dark:text-white mb-1 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 flex items-center gap-2\">\n                      <LineChart size={18} /> Live Chart\n                    </h3>\n                    <p className=\"text-sm text-slate-500\">Real-time market analysis and datafeed monitoring.</p>\n                  </button>\n                  <button onClick={() => setActiveView('ACCOUNTS')} className=\"p-4 bg-white dark:bg-slate-900/50 border border-slate-300 dark:border-slate-800 hover:border-emerald-500/50 hover:bg-white dark:hover:bg-slate-800 rounded-xl transition-all group shadow-sm\">\n                    <h3 className=\"font-bold text-slate-900 dark:text-white mb-1 group-hover:text-emerald-600 dark:group-hover:text-emerald-400 flex items-center gap-2\">\n                      <Users size={18} /> Accounts\n                    </h3>\n                    <p className=\"text-sm text-slate-500\">Manage trading instances and datafeed sources.</p>\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* --- VIEW: LIVE COCKPIT --- */}\n\n          {activeView === 'LIVE_COCKPIT' && (\n            <div className=\"h-full flex flex-col p-6 animate-in fade-in zoom-in-95 duration-300 overflow-hidden\">\n              <header className=\"mb-4 flex justify-between items-end border-b border-slate-800/50 pb-4 shrink-0\">\n                <div>\n                  <h2 className=\"text-2xl font-bold text-white flex items-center gap-2\">\n                    <Radio className=\"text-emerald-400\" /> Live Feed\n                  </h2>\n                  <p className=\"text-slate-500 mt-1 text-sm\">Real-time signals from Master Bot</p>\n                </div>\n              </header>\n\n              <div className=\"flex-1 flex gap-6 overflow-hidden min-h-0\">\n                {/* Collapsible Feed Panel (Live) */}\n                <div\n                  className={cn(\n                    \"flex flex-col bg-slate-900/30 border border-slate-800/50 rounded-2xl h-full transition-all duration-300 ease-in-out relative flex-shrink-0\",\n                    isLiveFeedCollapsed ? \"w-14 items-center pt-4\" : \"w-1/3 min-w-[320px] p-4\"\n                  )}\n                >\n                  {/* Header Row with Toggle */}\n                  <div className={cn(\"flex justify-between items-center mb-4 shrink-0\", isLiveFeedCollapsed && \"flex-col gap-4 mb-2\")}>\n                    {!isLiveFeedCollapsed ? (\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-1 h-5 bg-emerald-500 rounded-full\" />\n                        <h3 className=\"font-semibold text-slate-200\">Incoming Messages</h3>\n                      </div>\n                    ) : (\n                      <div className=\"w-1 h-5 bg-emerald-500 rounded-full\" />\n                    )}\n\n                    <button\n                      onClick={() => setIsLiveFeedCollapsed(!isLiveFeedCollapsed)}\n                      className=\"p-1.5 hover:bg-slate-800 rounded-lg text-slate-400 hover:text-white transition-colors\"\n                    >\n                      {isLiveFeedCollapsed ? <ChevronRight size={16} /> : <ChevronLeft size={16} />}\n                    </button>\n                  </div>\n\n                  {/* Content */}\n                  {!isLiveFeedCollapsed ? (\n                    <div className=\"flex-1 overflow-y-auto pr-2 space-y-3 scrollbar-thin scrollbar-thumb-slate-700 min-h-0 pb-2\">\n                      {liveMessages.length === 0 && <p className=\"text-slate-500 text-center mt-10 italic\">No live signals yet...</p>}\n                      {liveMessages.slice().reverse().map(msg => <MessageCard key={msg.id} message={msg} />)}\n                    </div>\n                  ) : (\n                    // Collapsed State Icon\n                    <div className=\"flex flex-col items-center gap-4 flex-1\">\n                      <Radio size={20} className=\"text-emerald-500 mt-4\" />\n                      <span className=\"text-[10px] text-slate-500 writing-vertical-rl rotate-180 uppercase tracking-widest font-mono mt-2\">Live Monitor</span>\n                    </div>\n                  )}\n                </div>\n\n                {/* Charts (Expands to fill) */}\n                <div className=\"flex-1 bg-slate-900/50 border border-slate-800 rounded-2xl flex flex-col shadow-xl overflow-hidden min-w-0\">\n                  <div className=\"p-4 border-b border-slate-800/50 flex justify-between items-center shrink-0\">\n                    <span className=\"font-semibold text-slate-300\">Live Analysis</span>\n                    <span className=\"text-xs bg-emerald-500/10 text-emerald-400 px-2 py-1 rounded border border-emerald-500/20\">LIVE</span>\n                  </div>\n                  <div className=\"flex-1 p-2 min-h-0 relative\">\n                    <div className=\"absolute inset-0\">\n                      <ChartContainer\n                        symbol=\"EURUSD\"\n                        symbolB=\"GBPUSD\"\n                        dataA={dataA}\n                        dataB={dataB}\n                        timeframe={timeframe}\n                        height=\"100%\"\n                        isActive={true}\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* --- VIEW: STRATEGY LAB --- */}\n          {activeView === 'STRATEGY_LAB' && (\n            <div className=\"h-full flex flex-col p-6 animate-in fade-in zoom-in-95 duration-300 overflow-hidden\">\n              <header className=\"mb-4 flex justify-between items-end border-b border-slate-800/50 pb-4 shrink-0\">\n                <div>\n                  <h2 className=\"text-2xl font-bold text-white flex items-center gap-2\">\n                    <FlaskConical className=\"text-amber-400\" /> Strategy Lab\n                  </h2>\n                  <p className=\"text-slate-500 mt-1 text-sm\">Backtest Results <span className=\"text-amber-500\">Analysis Mode</span></p>\n                </div>\n              </header>\n\n              <div className=\"flex-1 flex gap-6 overflow-hidden min-h-0\">\n                {/* Collapsible Feed Panel (Strategy) */}\n                <div\n                  className={cn(\n                    \"flex flex-col bg-slate-900/30 border border-slate-800/50 rounded-2xl h-full transition-all duration-300 ease-in-out relative flex-shrink-0\",\n                    isFeedCollapsed ? \"w-14 items-center pt-4\" : \"w-1/3 min-w-[320px] p-4\"\n                  )}\n                >\n                  {/* Header Row with Toggle */}\n                  <div className={cn(\"flex justify-between items-center mb-4 shrink-0\", isFeedCollapsed && \"flex-col gap-4 mb-2\")}>\n                    {!isFeedCollapsed ? (\n                      <h3 className=\"font-semibold text-slate-200 flex items-center gap-2\">\n                        <div className=\"w-1 h-5 bg-amber-500 rounded-full\" />\n                        Test Setups ({backtestMessages.length})\n                      </h3>\n                    ) : (\n                      <div className=\"w-1 h-5 bg-amber-500 rounded-full\" />\n                    )}\n\n                    <button\n                      onClick={() => setIsFeedCollapsed(!isFeedCollapsed)}\n                      className=\"p-1.5 hover:bg-slate-800 rounded-lg text-slate-400 hover:text-white transition-colors\"\n                    >\n                      {isFeedCollapsed ? <ChevronRight size={16} /> : <ChevronLeft size={16} />}\n                    </button>\n                  </div>\n\n                  {/* Content */}\n                  {!isFeedCollapsed ? (\n                    <div className=\"flex-1 overflow-y-auto pr-2 space-y-3 scrollbar-thin scrollbar-thumb-slate-700 min-h-0 pb-2\">\n                      {backtestMessages.length === 0 && <p className=\"text-slate-500 text-center mt-10 italic\">No backtest data found.</p>}\n                      {backtestMessages.slice().reverse().map(msg => (\n                        <div\n                          key={msg.id}\n                          onClick={() => handleSetupClick(msg)}\n                          className={cn(\n                            \"cursor-pointer transition-all duration-200 hover:scale-[1.02]\",\n                            selectedSetupId === msg.id ? \"ring-2 ring-amber-500 rounded-xl shadow-lg shadow-amber-900/20\" : \"\"\n                          )}\n                        >\n                          <MessageCard message={msg} />\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    // Collapsed State Icon\n                    <div className=\"flex flex-col items-center gap-4 flex-1\">\n                      <FlaskConical size={20} className=\"text-amber-500 mt-4\" />\n                      <span className=\"text-[10px] text-slate-500 writing-vertical-rl rotate-180 uppercase tracking-widest font-mono mt-2\">Results</span>\n                    </div>\n                  )}\n                </div>\n\n                {/* Analysis Column (Chart) */}\n                <div className=\"flex-1 bg-slate-900/50 border border-slate-700 rounded-2xl flex flex-col relative overflow-hidden shadow-2xl min-w-0\">\n                  {/* Chart Header */}\n                  <div className=\"h-12 border-b border-slate-800/50 flex items-center justify-between px-4 shrink-0 bg-slate-900/50\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"text-sm font-medium text-slate-300\">\n                        {messages.find(m => m.id === selectedSetupId)?.symbol || \"EURUSD\"}\n                      </span>\n                      <span className=\"text-slate-600\">|</span>\n                      <span className=\"text-[10px] text-slate-500 font-mono\">Analysis H4</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <button className=\"p-1.5 hover:bg-slate-800 rounded text-slate-400\"><Maximize2 size={16} /></button>\n                    </div>\n                  </div>\n\n                  {/* Chart Area */}\n                  <div className=\"flex-1 relative flex flex-col min-h-0 bg-slate-950/30\">\n                    {selectedSetupId && !isLoadingHistory ? (\n                      <div className=\"absolute inset-0 p-2\">\n                        <ChartContainer\n                          symbol={messages.find(m => m.id === selectedSetupId)?.symbol || \"EURUSD\"}\n                          symbolB=\"Correlation\"\n                          dataA={dataA}\n                          dataB={dataB}\n                          timeframe={timeframe}\n                          height=\"100%\"\n                          isActive={true}\n                        />\n                      </div>\n                    ) : (\n                      <div className=\"flex-1 flex flex-col items-center justify-center pointer-events-none\">\n                        {isLoadingHistory ? (\n                          <>\n                            <div className=\"w-10 h-10 border-4 border-amber-500/30 border-t-amber-500 rounded-full animate-spin mb-4\" />\n                            <h3 className=\"text-xl font-bold text-slate-400\">Loading History...</h3>\n                            <p className=\"text-slate-500 text-sm mt-1\">Bot is fetching OHLC data from MT5</p>\n                          </>\n                        ) : (\n                          <>\n                            <BarChart3 size={64} className=\"text-slate-700 mb-4 opacity-50\" />\n                            <h3 className=\"text-xl font-bold text-slate-500\">Select a Setup</h3>\n                            <p className=\"text-slate-600 text-sm mt-1\">Select a card from the left panel to load historical context.</p>\n                          </>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* --- VIEW: ACCOUNTS --- */}\n          {activeView === 'ACCOUNTS' && <AccountsView />}\n\n          {/* --- VIEW: SETTINGS --- */}\n          {activeView === 'SETTINGS' && <SettingsView />}\n\n          {/* --- VIEW: SYSTEM --- */}\n          {activeView === 'SYSTEM' && <SystemView />}\n\n          {/* --- VIEW: ASSET MAPPINGS --- */}\n          {activeView === 'ASSET_MAPPINGS' && (\n            <div className=\"h-full w-full animate-in fade-in zoom-in-95 duration-300 overflow-hidden\">\n              <AssetMappingPage onUpdate={checkMappings} />\n            </div>\n          )}\n\n          {/* --- VIEW: DISTRIBUTION --- */}\n          {activeView === 'DISTRIBUTION' && <DistributionView />}\n\n          {/* --- VIEW: DATAFEED --- */}\n          {activeView === 'DATAFEED' && <DatafeedView />}\n\n          {/* --- VIEW: DATA HISTORY --- */}\n          {activeView === 'DATA_HISTORY' && (\n            <div className=\"h-full w-full animate-in fade-in zoom-in-95 duration-300 overflow-hidden p-6\">\n              <DataHistoryPage />\n            </div>\n          )}\n\n          {/* --- VIEW: LIVE CHART --- */}\n          {activeView === 'LIVE_CHART' && (\n            <div className=\"h-full w-full animate-in fade-in zoom-in-95 duration-300\">\n              <LiveChartPage onNavigate={setActiveView} />\n            </div>\n          )}\n\n        </main>\n      </div>\n    </ChartThemeProvider>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}