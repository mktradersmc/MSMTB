{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Michael/IdeaProjects/MSMTB/src/trading-cockpit/src/components/trades/TradesPanel.tsx"],"sourcesContent":["import React, { useMemo, useState } from 'react';\r\nimport { ChevronRight, ChevronDown, CheckCircle, XCircle, Shield, Briefcase, Play, Pause, X, AlertTriangle } from 'lucide-react';\r\nimport { useTradeMonitor, AggregatedTrade } from '../../hooks/useTradeMonitor';\r\n\r\nexport const TradesPanel: React.FC<{\r\n    onClose: () => void;\r\n}> = ({ onClose }) => {\r\n    const { aggregatedTrades, modifyTrade } = useTradeMonitor();\r\n    const [expandedIds, setExpandedIds] = useState<Set<string>>(new Set());\r\n    // UI Local State for Action Feedback (Key: TradeID-Action)\r\n    const [actionStatus, setActionStatus] = useState<Record<string, 'PENDING' | 'SUCCESS' | 'ERROR'>>({});\r\n\r\n    const toggleExpand = (id: string) => {\r\n        const newSet = new Set(expandedIds);\r\n        if (newSet.has(id)) newSet.delete(id);\r\n        else newSet.add(id);\r\n        setExpandedIds(newSet);\r\n    };\r\n\r\n    const handleAction = (trade: AggregatedTrade, action: string, percent?: number) => {\r\n        // Direct execution per user request (No Confirmation)\r\n        modifyTrade({ action, tradeId: trade.tradeId, percent });\r\n    };\r\n\r\n    // const displayTrades = showHistory ? historyTrades : aggregatedTrades;\r\n    // const displayTrades = showHistory ? historyTrades : aggregatedTrades;\r\n    // Sort Descending (Newest First) per User Request\r\n    const displayTrades = [...aggregatedTrades].sort((a, b) => b.openTime - a.openTime);\r\n\r\n    // Group trades by Date\r\n    const groupedTrades = useMemo(() => {\r\n        const groups: { date: string, trades: AggregatedTrade[] }[] = [];\r\n        const dateMap = new Map<string, AggregatedTrade[]>();\r\n\r\n        displayTrades.forEach(t => {\r\n            const date = t.openTime ? new Date(t.openTime).toLocaleDateString(undefined, {\r\n                weekday: 'long',\r\n                year: 'numeric',\r\n                month: 'long',\r\n                day: 'numeric'\r\n            }) : 'Unknown Date';\r\n\r\n            if (!dateMap.has(date)) {\r\n                dateMap.set(date, []);\r\n                groups.push({ date, trades: dateMap.get(date)! });\r\n            }\r\n            dateMap.get(date)!.push(t);\r\n        });\r\n        return groups;\r\n    }, [displayTrades]);\r\n\r\n    const [panelHeight, setPanelHeight] = useState(300);\r\n\r\n    const startResizing = (e: React.MouseEvent) => {\r\n        e.preventDefault(); // Prevent text selection\r\n        const startY = e.clientY;\r\n        const startHeight = panelHeight;\r\n\r\n        const onMouseMove = (moveEvent: MouseEvent) => {\r\n            const delta = startY - moveEvent.clientY; // Dragging up increases height\r\n            setPanelHeight(Math.max(150, Math.min(window.innerHeight - 100, startHeight + delta)));\r\n        };\r\n\r\n        const onMouseUp = () => {\r\n            document.removeEventListener('mousemove', onMouseMove);\r\n            document.removeEventListener('mouseup', onMouseUp);\r\n        };\r\n\r\n        document.addEventListener('mousemove', onMouseMove);\r\n        document.addEventListener('mouseup', onMouseUp);\r\n    };\r\n\r\n    // Removed helper to use inline logic\r\n    return (\r\n        <div\r\n            style={{ height: panelHeight }}\r\n            className=\"bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700 flex flex-col animate-in slide-in-from-bottom duration-200 shadow-2xl relative\"\r\n        >\r\n            {/* Resizer Handle */}\r\n            <div\r\n                onMouseDown={startResizing}\r\n                className=\"absolute top-0 left-0 right-0 h-1 cursor-ns-resize hover:bg-blue-500/50 transition-colors z-50 group\"\r\n            >\r\n                <div className=\"mx-auto w-12 h-1 bg-slate-600/50 group-hover:bg-blue-400 rounded-full mt-0.5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n            </div>\r\n\r\n            {/* Header */}\r\n            <div className=\"h-8 bg-slate-100 dark:bg-slate-800 flex items-center justify-between px-2 shrink-0 border-b border-slate-200 dark:border-slate-700/50\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-xs font-bold text-slate-700 dark:text-slate-300\">\r\n                        Active Trades\r\n                    </span>\r\n                    <span className=\"text-[10px] text-slate-500\">\r\n                        {aggregatedTrades.length} Active\r\n                    </span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    {aggregatedTrades.length === 0 && <span className=\"text-[10px] text-slate-500 italic\">No active trades</span>}\r\n                    <button onClick={onClose} className=\"text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white transition-colors\">\r\n                        <X size={14} />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"flex-1 overflow-auto\">\r\n                <table className=\"w-full text-left border-collapse\">\r\n                    <thead className=\"bg-white dark:bg-slate-900 text-[10px] text-slate-500 font-mono sticky top-0 z-10 shadow-sm border-b border-slate-200 dark:border-slate-800\">\r\n                        <tr>\r\n                            <th className=\"p-1 w-6\"></th>\r\n                            <th className=\"p-1\">Time</th>\r\n                            <th className=\"p-1\">Trade</th>\r\n                            {/* <th className=\"p-1 text-right\">Vol</th> */}\r\n                            <th className=\"p-1 text-right\">Price</th>\r\n                            <th className=\"p-1 text-right\">SL</th>\r\n                            <th className=\"p-1 text-right\">TP</th>\r\n                            <th className=\"p-1 text-right\">Comm</th>\r\n                            <th className=\"p-1 text-right\">Realized</th>\r\n                            <th className=\"p-1 text-right\">Unrealized</th>\r\n                            <th className=\"p-1 text-right\">Plan R</th>\r\n                            <th className=\"p-1 text-right\">Run R</th>\r\n                            <th className=\"p-1 text-center\">Actions</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"text-[11px] text-slate-600 dark:text-slate-300 font-mono\">\r\n                        {groupedTrades.map(group => (\r\n                            <React.Fragment key={group.date}>\r\n                                {/* Date Header */}\r\n                                <tr>\r\n                                    <td colSpan={12} className=\"bg-slate-100/80 dark:bg-slate-800/80 px-2 py-1 text-[10px] font-bold text-slate-600 dark:text-slate-400 uppercase tracking-wide border-b border-slate-200 dark:border-slate-800\">\r\n                                        {group.date}\r\n                                    </td>\r\n                                </tr>\r\n\r\n                                {group.trades.map(trade => (\r\n                                    <React.Fragment key={trade.tradeId}>\r\n                                        {/* Parent Row */}\r\n                                        <tr className={`border-b ${trade.status === 'OFFLINE' ? 'border-slate-200 dark:border-slate-800/20 bg-slate-100/50 dark:bg-slate-900/50 opacity-60' : 'border-slate-200 dark:border-slate-800/50 hover:bg-slate-50 dark:hover:bg-slate-800/30'} transition-colors`}>\r\n                                            <td className=\"p-1 text-center cursor-pointer\" onClick={() => toggleExpand(trade.tradeId)}>\r\n                                                {expandedIds.has(trade.tradeId) ? <ChevronDown size={12} /> : <ChevronRight size={12} />}\r\n                                            </td>\r\n                                            <td className=\"p-1 text-slate-500 dark:text-slate-400\">\r\n                                                {/* Master Trade: Created Locally (Correct) */}\r\n                                                {new Date(trade.openTime).toLocaleTimeString()}\r\n                                            </td>\r\n                                            <td className=\"p-1\">\r\n                                                <div className=\"flex items-center gap-1\">\r\n                                                    <span className=\"font-bold text-slate-900 dark:text-slate-200\">{trade.symbol}</span>\r\n                                                    {/* Direction Badge */}\r\n                                                    <span className={`text-[9px] font-bold px-1 rounded ${trade.direction === 'BUY' ? 'bg-green-500/10 text-green-400' : 'bg-red-500/10 text-red-400'}`}>\r\n                                                        {trade.direction}\r\n                                                    </span>\r\n                                                </div>\r\n                                            </td>\r\n                                            {/* <td className=\"p-1 text-right\">{trade.totalVol.toFixed(2)}</td> */}\r\n                                            {/* MASTER ROW: TYPE (No Price) */}\r\n                                            {/* MASTER ROW: TYPE (No Price) */}\r\n                                            <td className=\"p-1 text-right font-bold text-slate-900 dark:text-white\">\r\n                                                {/* Display Order Type (MARKET/LIMIT) instead of Price */}\r\n                                                {(trade as any).type || 'MARKET'}\r\n                                            </td>\r\n                                            <td className=\"p-1 text-right text-slate-900 dark:text-white\">\r\n                                                {trade.slLabel ? <span className=\"text-purple-600 dark:text-purple-400 text-[10px]\">{trade.slLabel}</span> : (trade.avgSl > 0 ? trade.avgSl.toFixed(5) : '-')}\r\n                                            </td>\r\n                                            <td className=\"p-1 text-right text-slate-900 dark:text-white\">\r\n                                                {trade.tpLabel ? <span className=\"text-blue-600 dark:text-blue-400 text-[10px]\">{trade.tpLabel}</span> : (trade.avgTp > 0 ? trade.avgTp.toFixed(5) : '-')}\r\n                                            </td>\r\n\r\n                                            <td className={`p-1 text-right font-bold ${Math.abs(trade.totalCommission || 0) < 0.005 ? 'text-slate-900 dark:text-white' : ((trade.totalCommission || 0) > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                                {/* COMMISSION COLUMN (User Request) */}\r\n                                                {(trade.totalCommission || 0).toFixed(2)}\r\n                                            </td>\r\n                                            <td className={`p-1 text-right font-bold ${Math.abs(trade.realizedPl || 0) < 0.005 ? 'text-slate-900 dark:text-white' : ((trade.realizedPl || 0) > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                                {(trade.realizedPl || 0).toFixed(2)}\r\n                                            </td>\r\n                                            <td className={`p-1 text-right font-bold ${Math.abs(trade.unrealizedPl || 0) < 0.005 ? 'text-slate-900 dark:text-white' : ((trade.unrealizedPl || 0) > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                                {(trade.unrealizedPl || 0).toFixed(2)}\r\n                                            </td>\r\n\r\n                                            <td className=\"p-1 text-right text-slate-500\">{trade.currentRr > 0 ? trade.currentRr.toFixed(2) : '-'}</td>\r\n                                            <td className=\"p-1 text-right font-bold text-slate-700 dark:text-slate-300\">\r\n                                                {(trade.runningRr || 0).toFixed(2)}\r\n                                            </td>\r\n\r\n                                            <td className=\"p-1 flex items-center justify-center gap-1\">\r\n                                                {[\r\n                                                    { label: 'BE', action: 'SL_BE', title: 'Set SL to Break-Even' },\r\n                                                    { label: '25%', action: 'CLOSE_PARTIAL', percent: 0.25, title: 'Close 25%' },\r\n                                                    { label: '50%', action: 'CLOSE_PARTIAL', percent: 0.50, title: 'Close 50%' },\r\n                                                    { label: '75%', action: 'CLOSE_PARTIAL', percent: 0.75, title: 'Close 75%' },\r\n                                                    { label: '100%', action: 'CLOSE_PARTIAL', percent: 1.0, title: 'Close All' }\r\n                                                ].map(btn => {\r\n                                                    const key = `${trade.tradeId}-${btn.action}-${btn.percent || 'FULL'}`;\r\n                                                    const status = actionStatus[key];\r\n\r\n                                                    return (\r\n                                                        <button\r\n                                                            key={key}\r\n                                                            onClick={async () => {\r\n                                                                if (status === 'PENDING') return;\r\n                                                                setActionStatus(prev => ({ ...prev, [key]: 'PENDING' }));\r\n                                                                const s = await modifyTrade({ action: btn.action, tradeId: trade.tradeId, percent: btn.percent });\r\n                                                                if (s) {\r\n                                                                    setActionStatus(prev => ({ ...prev, [key]: 'SUCCESS' }));\r\n                                                                    setTimeout(() => setActionStatus(prev => { const n = { ...prev }; delete n[key]; return n; }), 1500);\r\n                                                                } else {\r\n                                                                    setActionStatus(prev => ({ ...prev, [key]: 'ERROR' }));\r\n                                                                    setTimeout(() => setActionStatus(prev => { const n = { ...prev }; delete n[key]; return n; }), 2000);\r\n                                                                }\r\n                                                            }}\r\n                                                            className={`\r\n                                                                min-w-[32px] h-[20px] text-[9px] font-bold uppercase transition-all flex items-center justify-center\r\n                                                                border border-slate-400 dark:border-slate-600 hover:border-slate-600 dark:hover:border-slate-400\r\n                                                                ${status === 'SUCCESS' ? 'bg-green-600 text-white border-green-500' : ''}\r\n                                                                ${status === 'ERROR' ? 'bg-red-600 text-white border-red-500' : ''}\r\n                                                                ${status === 'PENDING' ? 'bg-slate-200 dark:bg-slate-700 text-slate-400 cursor-wait' : 'bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 hover:text-slate-900 dark:hover:text-white'}\r\n                                                                rounded-none shadow-sm active:translate-y-[1px]\r\n                                                            `}\r\n                                                            title={btn.title}\r\n                                                        >\r\n                                                            {status === 'PENDING' ? '...' : (status === 'SUCCESS' ? '✔' : (status === 'ERROR' ? '✖' : btn.label))}\r\n                                                        </button>\r\n                                                    );\r\n                                                })}\r\n                                            </td>\r\n                                        </tr>\r\n\r\n                                        {/* Child Rows (Expanded) */}\r\n                                        {expandedIds.has(trade.tradeId) && trade.positions.map((pos, index) => {\r\n                                            // DYNAMIC OFFSET HEURISTIC\r\n                                            // 1. Master Trade Open Time (Local)\r\n                                            // 2. Position Time (Broker)\r\n                                            // 3. Diff (rounded to hours) = Broker Offset\r\n                                            // Warning: This only works if master trade and position are relatively close.\r\n                                            // If master is old and position is new, drift is small.\r\n                                            // BUT: We compare `trade.openTime` (db created_at) with `pos.time` (broker time).\r\n                                            // `pos.time` is usually a few seconds after `trade.openTime`.\r\n                                            // So `pos.time (seconds) * 1000 - trade.openTime` = Offset + Latency.\r\n                                            // Offset = Round((posMs - tradeMs) / 3600000) * 3600000.\r\n\r\n                                            let displayTime = \"-\";\r\n                                            if (pos.time) {\r\n                                                const posMs = pos.time * 1000;\r\n                                                const tradeMs = trade.openTime;\r\n                                                const diff = posMs - tradeMs;\r\n\r\n                                                // Round to nearest hour (3600000 ms)\r\n                                                // e.g. Broker UTC+2. Diff approx +7,200,000 ms.\r\n                                                // If diff is large (>30 mins), it's likely an offset.\r\n                                                const offsetHours = Math.round(diff / 3600000);\r\n                                                const offsetMs = offsetHours * 3600000;\r\n\r\n                                                // Corrected Time = BrokerTime - Offset\r\n                                                const corrected = posMs - offsetMs;\r\n\r\n                                                displayTime = new Date(corrected).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });\r\n                                            }\r\n\r\n                                            return (\r\n                                                <tr key={`${pos.botId}-${pos.brokerId}-${index}`} className={`bg-slate-50 dark:bg-slate-900/50 text-[10px] text-slate-500 ${pos.status === 'OFFLINE' ? 'opacity-40 grayscale pointer-events-none' : ''}`}>\r\n                                                    <td className=\"p-1\"></td>\r\n                                                    <td className=\"p-1 pl-4 text-[10px] text-slate-500 font-mono font-bold\">\r\n                                                        {pos.status === 'OFFLINE' ? (\r\n                                                            <span className=\"text-slate-600 font-bold border border-slate-300 dark:border-slate-700 px-1 rounded-[2px]\">OFFLINE</span>\r\n                                                        ) : (\r\n                                                            pos.status === 'SENT' && !pos.time ? (\r\n                                                                <span className=\"text-amber-500 font-bold animate-pulse\">SENT</span>\r\n                                                            ) : (\r\n                                                                displayTime\r\n                                                            )\r\n                                                        )}\r\n                                                    </td>\r\n                                                    <td className=\"p-1 font-mono font-bold text-slate-900 dark:text-white\">{pos.brokerId}</td>\r\n                                                    {/* <td className=\"p-1 text-right\">{(pos.vol || 0).toFixed(2)}</td> */}\r\n                                                    <td className=\"p-1 text-right text-slate-900 dark:text-white\">\r\n                                                        {(pos.open || 0).toFixed(5)}\r\n                                                    </td>\r\n                                                    <td className=\"p-1 text-right text-slate-900 dark:text-white\">{(pos.sl || 0).toFixed(5)}</td>\r\n                                                    <td className=\"p-1 text-right text-slate-900 dark:text-white\">{(pos.tp || 0).toFixed(5)}</td>\r\n\r\n                                                    {/* CHILD COMMISSION */}\r\n                                                    <td className={`p-1 text-right ${Math.abs(pos.commission || 0) < 0.005 ? 'text-slate-900 dark:text-white' : ((pos.commission || 0) > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>{(pos.commission || 0).toFixed(2)}</td>\r\n\r\n                                                    <td className={`p-1 text-right ${Math.abs(pos.realizedPl || 0) < 0.005 ? 'text-slate-900 dark:text-white' : ((pos.realizedPl || 0) > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>{(pos.realizedPl || 0).toFixed(2)}</td>\r\n                                                    <td className={`p-1 text-right ${Math.abs(pos.profit || 0) < 0.005 ? 'text-slate-900 dark:text-white' : ((pos.profit || 0) > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                                        {(pos.profit || 0).toFixed(2)}\r\n                                                    </td>\r\n\r\n                                                    {/* CHILD PLAN R */}\r\n                                                    <td className=\"p-1 text-right text-slate-900 dark:text-white\">\r\n                                                        {(() => {\r\n                                                            const distSl = Math.abs((pos.open || 0) - (pos.sl || 0));\r\n                                                            const distTp = Math.abs((pos.tp || 0) - (pos.open || 0));\r\n                                                            if (distSl > 0 && pos.tp > 0) {\r\n                                                                return (distTp / distSl).toFixed(2);\r\n                                                            }\r\n                                                            return '-';\r\n                                                        })()}\r\n                                                    </td>\r\n\r\n                                                    {/* CHILD RUN R */}\r\n                                                    <td className=\"p-1 text-right text-slate-900 dark:text-white\">\r\n                                                        {(pos.runningRr !== undefined) ? (pos.runningRr).toFixed(2) : '-'}\r\n                                                    </td>\r\n\r\n                                                    <td className=\"p-1 text-center\"></td>\r\n                                                </tr>\r\n                                            );\r\n                                        })}\r\n                                    </React.Fragment>\r\n                                ))}\r\n                            </React.Fragment>\r\n                        ))}\r\n                    </tbody>\r\n                    <tfoot className=\"bg-slate-50 dark:bg-slate-900 text-[11px] font-mono font-bold text-slate-700 dark:text-slate-300 sticky bottom-0 z-10 shadow-[0_-1px_0_theme(colors.slate.300)] dark:shadow-[0_-1px_0_theme(colors.slate.700)]\">\r\n                        {(() => {\r\n                            const totals = displayTrades.reduce((acc, t) => ({\r\n                                comm: acc.comm + (t.totalCommission || 0),\r\n                                realized: acc.realized + (t.realizedPl || 0),\r\n                                unrealized: acc.unrealized + (t.unrealizedPl || 0)\r\n                            }), { comm: 0, realized: 0, unrealized: 0 });\r\n\r\n                            return (\r\n                                <tr>\r\n                                    <td className=\"p-2\"></td>\r\n                                    <td className=\"p-2 text-slate-500 uppercase tracking-wider text-[10px]\">Total</td>\r\n                                    <td className=\"p-2\"></td>\r\n                                    <td className=\"p-2\"></td>\r\n                                    <td className=\"p-2\"></td>\r\n                                    <td className=\"p-2\"></td>\r\n\r\n                                    {/* Comm */}\r\n                                    <td className={`p-2 text-right ${Math.abs(totals.comm) < 0.005 ? 'text-slate-500' : (totals.comm > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                        {totals.comm.toFixed(2)}\r\n                                    </td>\r\n\r\n                                    {/* Realized */}\r\n                                    <td className={`p-2 text-right ${Math.abs(totals.realized) < 0.005 ? 'text-slate-500' : (totals.realized > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                        {totals.realized.toFixed(2)}\r\n                                    </td>\r\n\r\n                                    {/* Unrealized */}\r\n                                    <td className={`p-2 text-right ${Math.abs(totals.unrealized) < 0.005 ? 'text-slate-500' : (totals.unrealized > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                        {totals.unrealized.toFixed(2)}\r\n                                    </td>\r\n\r\n                                    <td className=\"p-2\"></td>\r\n                                    <td className=\"p-2\"></td>\r\n                                    <td className=\"p-2\"></td>\r\n                                </tr>\r\n                            );\r\n                        })()}\r\n                    </tfoot>\r\n                </table>\r\n            </div>\r\n        </div >\r\n    );\r\n};\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;AACA;;;;;;AAEO,MAAM,cAER,CAAC,EAAE,OAAO,EAAE;;IACb,MAAM,EAAE,gBAAgB,EAAE,WAAW,EAAE,GAAG,IAAA,qJAAe;IACzD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAc,IAAI;IAChE,2DAA2D;IAC3D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAkD,CAAC;IAEnG,MAAM,eAAe,CAAC;QAClB,MAAM,SAAS,IAAI,IAAI;QACvB,IAAI,OAAO,GAAG,CAAC,KAAK,OAAO,MAAM,CAAC;aAC7B,OAAO,GAAG,CAAC;QAChB,eAAe;IACnB;IAEA,MAAM,eAAe,CAAC,OAAwB,QAAgB;QAC1D,sDAAsD;QACtD,YAAY;YAAE;YAAQ,SAAS,MAAM,OAAO;YAAE;QAAQ;IAC1D;IAEA,wEAAwE;IACxE,wEAAwE;IACxE,kDAAkD;IAClD,MAAM,gBAAgB;WAAI;KAAiB,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,QAAQ,GAAG,EAAE,QAAQ;IAElF,uBAAuB;IACvB,MAAM,gBAAgB,IAAA,wKAAO;8CAAC;YAC1B,MAAM,SAAwD,EAAE;YAChE,MAAM,UAAU,IAAI;YAEpB,cAAc,OAAO;sDAAC,CAAA;oBAClB,MAAM,OAAO,EAAE,QAAQ,GAAG,IAAI,KAAK,EAAE,QAAQ,EAAE,kBAAkB,CAAC,WAAW;wBACzE,SAAS;wBACT,MAAM;wBACN,OAAO;wBACP,KAAK;oBACT,KAAK;oBAEL,IAAI,CAAC,QAAQ,GAAG,CAAC,OAAO;wBACpB,QAAQ,GAAG,CAAC,MAAM,EAAE;wBACpB,OAAO,IAAI,CAAC;4BAAE;4BAAM,QAAQ,QAAQ,GAAG,CAAC;wBAAO;oBACnD;oBACA,QAAQ,GAAG,CAAC,MAAO,IAAI,CAAC;gBAC5B;;YACA,OAAO;QACX;6CAAG;QAAC;KAAc;IAElB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAE/C,MAAM,gBAAgB,CAAC;QACnB,EAAE,cAAc,IAAI,yBAAyB;QAC7C,MAAM,SAAS,EAAE,OAAO;QACxB,MAAM,cAAc;QAEpB,MAAM,cAAc,CAAC;YACjB,MAAM,QAAQ,SAAS,UAAU,OAAO,EAAE,+BAA+B;YACzE,eAAe,KAAK,GAAG,CAAC,KAAK,KAAK,GAAG,CAAC,OAAO,WAAW,GAAG,KAAK,cAAc;QAClF;QAEA,MAAM,YAAY;YACd,SAAS,mBAAmB,CAAC,aAAa;YAC1C,SAAS,mBAAmB,CAAC,WAAW;QAC5C;QAEA,SAAS,gBAAgB,CAAC,aAAa;QACvC,SAAS,gBAAgB,CAAC,WAAW;IACzC;IAEA,qCAAqC;IACrC,qBACI,6LAAC;QACG,OAAO;YAAE,QAAQ;QAAY;QAC7B,WAAU;;0BAGV,6LAAC;gBACG,aAAa;gBACb,WAAU;0BAEV,cAAA,6LAAC;oBAAI,WAAU;;;;;;;;;;;0BAInB,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAK,WAAU;0CAAuD;;;;;;0CAGvE,6LAAC;gCAAK,WAAU;;oCACX,iBAAiB,MAAM;oCAAC;;;;;;;;;;;;;kCAGjC,6LAAC;wBAAI,WAAU;;4BACV,iBAAiB,MAAM,KAAK,mBAAK,6LAAC;gCAAK,WAAU;0CAAoC;;;;;;0CACtF,6LAAC;gCAAO,SAAS;gCAAS,WAAU;0CAChC,cAAA,6LAAC,oMAAC;oCAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;0BAMrB,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBAAM,WAAU;;sCACb,6LAAC;4BAAM,WAAU;sCACb,cAAA,6LAAC;;kDACG,6LAAC;wCAAG,WAAU;;;;;;kDACd,6LAAC;wCAAG,WAAU;kDAAM;;;;;;kDACpB,6LAAC;wCAAG,WAAU;kDAAM;;;;;;kDAEpB,6LAAC;wCAAG,WAAU;kDAAiB;;;;;;kDAC/B,6LAAC;wCAAG,WAAU;kDAAiB;;;;;;kDAC/B,6LAAC;wCAAG,WAAU;kDAAiB;;;;;;kDAC/B,6LAAC;wCAAG,WAAU;kDAAiB;;;;;;kDAC/B,6LAAC;wCAAG,WAAU;kDAAiB;;;;;;kDAC/B,6LAAC;wCAAG,WAAU;kDAAiB;;;;;;kDAC/B,6LAAC;wCAAG,WAAU;kDAAiB;;;;;;kDAC/B,6LAAC;wCAAG,WAAU;kDAAiB;;;;;;kDAC/B,6LAAC;wCAAG,WAAU;kDAAkB;;;;;;;;;;;;;;;;;sCAGxC,6LAAC;4BAAM,WAAU;sCACZ,cAAc,GAAG,CAAC,CAAA,sBACf,6LAAC,wKAAK,CAAC,QAAQ;;sDAEX,6LAAC;sDACG,cAAA,6LAAC;gDAAG,SAAS;gDAAI,WAAU;0DACtB,MAAM,IAAI;;;;;;;;;;;wCAIlB,MAAM,MAAM,CAAC,GAAG,CAAC,CAAA,sBACd,6LAAC,wKAAK,CAAC,QAAQ;;kEAEX,6LAAC;wDAAG,WAAW,CAAC,SAAS,EAAE,MAAM,MAAM,KAAK,YAAY,8FAA8F,yFAAyF,kBAAkB,CAAC;;0EAC9P,6LAAC;gEAAG,WAAU;gEAAiC,SAAS,IAAM,aAAa,MAAM,OAAO;0EACnF,YAAY,GAAG,CAAC,MAAM,OAAO,kBAAI,6LAAC,sOAAW;oEAAC,MAAM;;;;;6HAAS,6LAAC,yOAAY;oEAAC,MAAM;;;;;;;;;;;0EAEtF,6LAAC;gEAAG,WAAU;0EAET,IAAI,KAAK,MAAM,QAAQ,EAAE,kBAAkB;;;;;;0EAEhD,6LAAC;gEAAG,WAAU;0EACV,cAAA,6LAAC;oEAAI,WAAU;;sFACX,6LAAC;4EAAK,WAAU;sFAAgD,MAAM,MAAM;;;;;;sFAE5E,6LAAC;4EAAK,WAAW,CAAC,kCAAkC,EAAE,MAAM,SAAS,KAAK,QAAQ,mCAAmC,8BAA8B;sFAC9I,MAAM,SAAS;;;;;;;;;;;;;;;;;0EAO5B,6LAAC;gEAAG,WAAU;0EAET,AAAC,MAAc,IAAI,IAAI;;;;;;0EAE5B,6LAAC;gEAAG,WAAU;0EACT,MAAM,OAAO,iBAAG,6LAAC;oEAAK,WAAU;8EAAoD,MAAM,OAAO;;;;;+GAAY,MAAM,KAAK,GAAG,IAAI,MAAM,KAAK,CAAC,OAAO,CAAC,KAAK;;;;;;0EAE7J,6LAAC;gEAAG,WAAU;0EACT,MAAM,OAAO,iBAAG,6LAAC;oEAAK,WAAU;8EAAgD,MAAM,OAAO;;;;;+GAAY,MAAM,KAAK,GAAG,IAAI,MAAM,KAAK,CAAC,OAAO,CAAC,KAAK;;;;;;0EAGzJ,6LAAC;gEAAG,WAAW,CAAC,yBAAyB,EAAE,KAAK,GAAG,CAAC,MAAM,eAAe,IAAI,KAAK,QAAQ,mCAAoC,CAAC,MAAM,eAAe,IAAI,CAAC,IAAI,IAAI,uCAAuC,kCAAmC;0EAEtO,CAAC,MAAM,eAAe,IAAI,CAAC,EAAE,OAAO,CAAC;;;;;;0EAE1C,6LAAC;gEAAG,WAAW,CAAC,yBAAyB,EAAE,KAAK,GAAG,CAAC,MAAM,UAAU,IAAI,KAAK,QAAQ,mCAAoC,CAAC,MAAM,UAAU,IAAI,CAAC,IAAI,IAAI,uCAAuC,kCAAmC;0EAC5N,CAAC,MAAM,UAAU,IAAI,CAAC,EAAE,OAAO,CAAC;;;;;;0EAErC,6LAAC;gEAAG,WAAW,CAAC,yBAAyB,EAAE,KAAK,GAAG,CAAC,MAAM,YAAY,IAAI,KAAK,QAAQ,mCAAoC,CAAC,MAAM,YAAY,IAAI,CAAC,IAAI,IAAI,uCAAuC,kCAAmC;0EAChO,CAAC,MAAM,YAAY,IAAI,CAAC,EAAE,OAAO,CAAC;;;;;;0EAGvC,6LAAC;gEAAG,WAAU;0EAAiC,MAAM,SAAS,GAAG,IAAI,MAAM,SAAS,CAAC,OAAO,CAAC,KAAK;;;;;;0EAClG,6LAAC;gEAAG,WAAU;0EACT,CAAC,MAAM,SAAS,IAAI,CAAC,EAAE,OAAO,CAAC;;;;;;0EAGpC,6LAAC;gEAAG,WAAU;0EACT;oEACG;wEAAE,OAAO;wEAAM,QAAQ;wEAAS,OAAO;oEAAuB;oEAC9D;wEAAE,OAAO;wEAAO,QAAQ;wEAAiB,SAAS;wEAAM,OAAO;oEAAY;oEAC3E;wEAAE,OAAO;wEAAO,QAAQ;wEAAiB,SAAS;wEAAM,OAAO;oEAAY;oEAC3E;wEAAE,OAAO;wEAAO,QAAQ;wEAAiB,SAAS;wEAAM,OAAO;oEAAY;oEAC3E;wEAAE,OAAO;wEAAQ,QAAQ;wEAAiB,SAAS;wEAAK,OAAO;oEAAY;iEAC9E,CAAC,GAAG,CAAC,CAAA;oEACF,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,CAAC,EAAE,IAAI,MAAM,CAAC,CAAC,EAAE,IAAI,OAAO,IAAI,QAAQ;oEACrE,MAAM,SAAS,YAAY,CAAC,IAAI;oEAEhC,qBACI,6LAAC;wEAEG,SAAS;4EACL,IAAI,WAAW,WAAW;4EAC1B,gBAAgB,CAAA,OAAQ,CAAC;oFAAE,GAAG,IAAI;oFAAE,CAAC,IAAI,EAAE;gFAAU,CAAC;4EACtD,MAAM,IAAI,MAAM,YAAY;gFAAE,QAAQ,IAAI,MAAM;gFAAE,SAAS,MAAM,OAAO;gFAAE,SAAS,IAAI,OAAO;4EAAC;4EAC/F,IAAI,GAAG;gFACH,gBAAgB,CAAA,OAAQ,CAAC;wFAAE,GAAG,IAAI;wFAAE,CAAC,IAAI,EAAE;oFAAU,CAAC;gFACtD,WAAW,IAAM,gBAAgB,CAAA;wFAAU,MAAM,IAAI;4FAAE,GAAG,IAAI;wFAAC;wFAAG,OAAO,CAAC,CAAC,IAAI;wFAAE,OAAO;oFAAG,IAAI;4EACnG,OAAO;gFACH,gBAAgB,CAAA,OAAQ,CAAC;wFAAE,GAAG,IAAI;wFAAE,CAAC,IAAI,EAAE;oFAAQ,CAAC;gFACpD,WAAW,IAAM,gBAAgB,CAAA;wFAAU,MAAM,IAAI;4FAAE,GAAG,IAAI;wFAAC;wFAAG,OAAO,CAAC,CAAC,IAAI;wFAAE,OAAO;oFAAG,IAAI;4EACnG;wEACJ;wEACA,WAAW,CAAC;;;gEAGR,EAAE,WAAW,YAAY,6CAA6C,GAAG;gEACzE,EAAE,WAAW,UAAU,yCAAyC,GAAG;gEACnE,EAAE,WAAW,YAAY,8DAA8D,0JAA0J;;4DAErP,CAAC;wEACD,OAAO,IAAI,KAAK;kFAEf,WAAW,YAAY,QAAS,WAAW,YAAY,MAAO,WAAW,UAAU,MAAM,IAAI,KAAK;uEAvB9F;;;;;gEA0BjB;;;;;;;;;;;;oDAKP,YAAY,GAAG,CAAC,MAAM,OAAO,KAAK,MAAM,SAAS,CAAC,GAAG,CAAC,CAAC,KAAK;wDACzD,2BAA2B;wDAC3B,oCAAoC;wDACpC,4BAA4B;wDAC5B,6CAA6C;wDAC7C,8EAA8E;wDAC9E,wDAAwD;wDACxD,kFAAkF;wDAClF,8DAA8D;wDAC9D,sEAAsE;wDACtE,yDAAyD;wDAEzD,IAAI,cAAc;wDAClB,IAAI,IAAI,IAAI,EAAE;4DACV,MAAM,QAAQ,IAAI,IAAI,GAAG;4DACzB,MAAM,UAAU,MAAM,QAAQ;4DAC9B,MAAM,OAAO,QAAQ;4DAErB,qCAAqC;4DACrC,gDAAgD;4DAChD,sDAAsD;4DACtD,MAAM,cAAc,KAAK,KAAK,CAAC,OAAO;4DACtC,MAAM,WAAW,cAAc;4DAE/B,uCAAuC;4DACvC,MAAM,YAAY,QAAQ;4DAE1B,cAAc,IAAI,KAAK,WAAW,kBAAkB,CAAC,EAAE,EAAE;gEAAE,MAAM;gEAAW,QAAQ;gEAAW,QAAQ;4DAAU;wDACrH;wDAEA,qBACI,6LAAC;4DAAiD,WAAW,CAAC,4DAA4D,EAAE,IAAI,MAAM,KAAK,YAAY,6CAA6C,IAAI;;8EACpM,6LAAC;oEAAG,WAAU;;;;;;8EACd,6LAAC;oEAAG,WAAU;8EACT,IAAI,MAAM,KAAK,0BACZ,6LAAC;wEAAK,WAAU;kFAA4F;;;;;mHAE5G,IAAI,MAAM,KAAK,UAAU,CAAC,IAAI,IAAI,iBAC9B,6LAAC;wEAAK,WAAU;kFAAyC;;;;;mHAEzD;;;;;;8EAIZ,6LAAC;oEAAG,WAAU;8EAA0D,IAAI,QAAQ;;;;;;8EAEpF,6LAAC;oEAAG,WAAU;8EACT,CAAC,IAAI,IAAI,IAAI,CAAC,EAAE,OAAO,CAAC;;;;;;8EAE7B,6LAAC;oEAAG,WAAU;8EAAiD,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,OAAO,CAAC;;;;;;8EACrF,6LAAC;oEAAG,WAAU;8EAAiD,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,OAAO,CAAC;;;;;;8EAGrF,6LAAC;oEAAG,WAAW,CAAC,eAAe,EAAE,KAAK,GAAG,CAAC,IAAI,UAAU,IAAI,KAAK,QAAQ,mCAAoC,CAAC,IAAI,UAAU,IAAI,CAAC,IAAI,IAAI,uCAAuC,kCAAmC;8EAAG,CAAC,IAAI,UAAU,IAAI,CAAC,EAAE,OAAO,CAAC;;;;;;8EAEpP,6LAAC;oEAAG,WAAW,CAAC,eAAe,EAAE,KAAK,GAAG,CAAC,IAAI,UAAU,IAAI,KAAK,QAAQ,mCAAoC,CAAC,IAAI,UAAU,IAAI,CAAC,IAAI,IAAI,uCAAuC,kCAAmC;8EAAG,CAAC,IAAI,UAAU,IAAI,CAAC,EAAE,OAAO,CAAC;;;;;;8EACpP,6LAAC;oEAAG,WAAW,CAAC,eAAe,EAAE,KAAK,GAAG,CAAC,IAAI,MAAM,IAAI,KAAK,QAAQ,mCAAoC,CAAC,IAAI,MAAM,IAAI,CAAC,IAAI,IAAI,uCAAuC,kCAAmC;8EACtM,CAAC,IAAI,MAAM,IAAI,CAAC,EAAE,OAAO,CAAC;;;;;;8EAI/B,6LAAC;oEAAG,WAAU;8EACT,CAAC;wEACE,MAAM,SAAS,KAAK,GAAG,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC;wEACtD,MAAM,SAAS,KAAK,GAAG,CAAC,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC;wEACtD,IAAI,SAAS,KAAK,IAAI,EAAE,GAAG,GAAG;4EAC1B,OAAO,CAAC,SAAS,MAAM,EAAE,OAAO,CAAC;wEACrC;wEACA,OAAO;oEACX,CAAC;;;;;;8EAIL,6LAAC;oEAAG,WAAU;8EACT,AAAC,IAAI,SAAS,KAAK,YAAa,AAAC,IAAI,SAAS,CAAE,OAAO,CAAC,KAAK;;;;;;8EAGlE,6LAAC;oEAAG,WAAU;;;;;;;2DA9CT,GAAG,IAAI,KAAK,CAAC,CAAC,EAAE,IAAI,QAAQ,CAAC,CAAC,EAAE,OAAO;;;;;oDAiDxD;;+CA7KiB,MAAM,OAAO;;;;;;mCATrB,MAAM,IAAI;;;;;;;;;;sCA4LvC,6LAAC;4BAAM,WAAU;sCACZ,CAAC;gCACE,MAAM,SAAS,cAAc,MAAM,CAAC,CAAC,KAAK,IAAM,CAAC;wCAC7C,MAAM,IAAI,IAAI,GAAG,CAAC,EAAE,eAAe,IAAI,CAAC;wCACxC,UAAU,IAAI,QAAQ,GAAG,CAAC,EAAE,UAAU,IAAI,CAAC;wCAC3C,YAAY,IAAI,UAAU,GAAG,CAAC,EAAE,YAAY,IAAI,CAAC;oCACrD,CAAC,GAAG;oCAAE,MAAM;oCAAG,UAAU;oCAAG,YAAY;gCAAE;gCAE1C,qBACI,6LAAC;;sDACG,6LAAC;4CAAG,WAAU;;;;;;sDACd,6LAAC;4CAAG,WAAU;sDAA0D;;;;;;sDACxE,6LAAC;4CAAG,WAAU;;;;;;sDACd,6LAAC;4CAAG,WAAU;;;;;;sDACd,6LAAC;4CAAG,WAAU;;;;;;sDACd,6LAAC;4CAAG,WAAU;;;;;;sDAGd,6LAAC;4CAAG,WAAW,CAAC,eAAe,EAAE,KAAK,GAAG,CAAC,OAAO,IAAI,IAAI,QAAQ,mBAAoB,OAAO,IAAI,GAAG,IAAI,uCAAuC,kCAAmC;sDAC5K,OAAO,IAAI,CAAC,OAAO,CAAC;;;;;;sDAIzB,6LAAC;4CAAG,WAAW,CAAC,eAAe,EAAE,KAAK,GAAG,CAAC,OAAO,QAAQ,IAAI,QAAQ,mBAAoB,OAAO,QAAQ,GAAG,IAAI,uCAAuC,kCAAmC;sDACpL,OAAO,QAAQ,CAAC,OAAO,CAAC;;;;;;sDAI7B,6LAAC;4CAAG,WAAW,CAAC,eAAe,EAAE,KAAK,GAAG,CAAC,OAAO,UAAU,IAAI,QAAQ,mBAAoB,OAAO,UAAU,GAAG,IAAI,uCAAuC,kCAAmC;sDACxL,OAAO,UAAU,CAAC,OAAO,CAAC;;;;;;sDAG/B,6LAAC;4CAAG,WAAU;;;;;;sDACd,6LAAC;4CAAG,WAAU;;;;;;sDACd,6LAAC;4CAAG,WAAU;;;;;;;;;;;;4BAG1B,CAAC;;;;;;;;;;;;;;;;;;;;;;;AAMzB;GAjWa;;QAGiC,qJAAe;;;KAHhD"}},
    {"offset": {"line": 876, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Michael/IdeaProjects/MSMTB/src/trading-cockpit/src/components/trades/HistoryPanel.tsx"],"sourcesContent":["\r\nimport React, { useMemo, useState, useEffect } from 'react';\r\nimport { ChevronRight, ChevronDown, CheckCircle, XCircle, Shield, Briefcase, Play, Pause, X, AlertTriangle, RefreshCw } from 'lucide-react';\r\nimport { AggregatedTrade } from '../../hooks/useTradeMonitor'; // Reuse Type\r\nimport { useWorkspaceStore } from '../../stores/useWorkspaceStore';\r\n\r\nexport const HistoryPanel: React.FC<{\r\n    onClose: () => void;\r\n}> = ({ onClose }) => {\r\n    const isTestMode = useWorkspaceStore(state => state.isTestMode);\r\n    const [trades, setTrades] = useState<AggregatedTrade[]>([]);\r\n    const [expandedIds, setExpandedIds] = useState<Set<string>>(new Set());\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const toggleExpand = (id: string) => {\r\n        const newSet = new Set(expandedIds);\r\n        if (newSet.has(id)) newSet.delete(id);\r\n        else newSet.add(id);\r\n        setExpandedIds(newSet);\r\n    };\r\n\r\n    const loadHistory = async () => {\r\n        setIsLoading(true);\r\n        try {\r\n            const envParam = isTestMode ? 'test' : 'live';\r\n            const res = await fetch(`http://localhost:3005/api/trade-history?limit=50&env=${envParam}`);\r\n            const body = await res.json();\r\n            if (body.success) {\r\n                const mapped: AggregatedTrade[] = body.history.map((h: any) => ({\r\n                    tradeId: h.id,\r\n                    symbol: h.symbol,\r\n                    direction: h.direction === 1 ? 'BUY' : 'SELL', // DB stores int\r\n                    active: false,\r\n                    status: 'CLOSED',\r\n                    openTime: h.open_time,\r\n                    closeTime: h.close_time,\r\n                    entryPrice: h.entry_price,\r\n                    exitPrice: h.exit_price,\r\n                    activePrice: h.exit_price,\r\n                    volume: h.volume,\r\n                    realizedPl: h.profit,\r\n                    commission: h.commission,\r\n                    swap: h.swap,\r\n                    positions: (h.positions || []).map((p: any) => ({\r\n                        id: p.id,\r\n                        brokerId: p.broker_id,\r\n                        botId: p.bot_id,\r\n                        status: p.status,\r\n                        realizedPl: p.realized_pl,\r\n                        commission: p.commission,\r\n                        swap: p.swap,\r\n                        entryPrice: p.entry_price || h.entry_price, // Fallback\r\n                        currentPrice: p.exit_price || h.exit_price,\r\n                        volume: p.volume\r\n                    })),\r\n                    botId: 'HISTORY',\r\n                    brokerId: 'HISTORY',\r\n                    unrealizedPl: 0,\r\n                    runningRr: 0,\r\n                    currentRr: 0,\r\n                    sl: 0, tp: 0, avgPrice: h.exit_price || 0,\r\n                    strategy: h.strategy,\r\n                    entryLabel: 'Market',\r\n                }));\r\n                setTrades(mapped);\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Failed to load history\", e);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    // Reload when Environment Toggles or Mounts\r\n    useEffect(() => {\r\n        loadHistory();\r\n    }, [isTestMode]);\r\n\r\n    const [panelHeight, setPanelHeight] = useState(300);\r\n\r\n    const startResizing = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        const startY = e.clientY;\r\n        const startHeight = panelHeight;\r\n\r\n        const onMouseMove = (moveEvent: MouseEvent) => {\r\n            const delta = startY - moveEvent.clientY;\r\n            setPanelHeight(Math.max(150, Math.min(window.innerHeight - 100, startHeight + delta)));\r\n        };\r\n\r\n        const onMouseUp = () => {\r\n            document.removeEventListener('mousemove', onMouseMove);\r\n            document.removeEventListener('mouseup', onMouseUp);\r\n        };\r\n\r\n        document.addEventListener('mousemove', onMouseMove);\r\n        document.addEventListener('mouseup', onMouseUp);\r\n    };\r\n\r\n    // Group trades by Date\r\n    const groupedTrades = useMemo(() => {\r\n        const groups: { date: string, trades: AggregatedTrade[] }[] = [];\r\n        const dateMap = new Map<string, AggregatedTrade[]>();\r\n\r\n        trades.forEach(t => {\r\n            const date = t.openTime ? new Date(t.openTime).toLocaleDateString(undefined, {\r\n                weekday: 'long',\r\n                year: 'numeric',\r\n                month: 'long',\r\n                day: 'numeric'\r\n            }) : 'Unknown Date';\r\n\r\n            if (!dateMap.has(date)) {\r\n                dateMap.set(date, []);\r\n                groups.push({ date, trades: dateMap.get(date)! });\r\n            }\r\n            dateMap.get(date)!.push(t);\r\n        });\r\n        return groups;\r\n    }, [trades]);\r\n\r\n    return (\r\n        <div\r\n            style={{ height: panelHeight }}\r\n            className=\"bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700 flex flex-col animate-in slide-in-from-bottom duration-200 shadow-2xl relative\"\r\n        >\r\n            {/* Resizer Handle */}\r\n            <div\r\n                onMouseDown={startResizing}\r\n                className=\"absolute top-0 left-0 right-0 h-1 cursor-ns-resize hover:bg-blue-500/50 transition-colors z-50 group\"\r\n            >\r\n                <div className=\"absolute top-0 left-1/2 -translate-x-1/2 w-20 h-0.5 bg-slate-600 group-hover:bg-blue-400 rounded-b opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n            </div>\r\n\r\n            {/* Header */}\r\n            <div className=\"h-8 bg-slate-100 dark:bg-slate-800 flex items-center justify-between px-2 shrink-0 border-b border-slate-200 dark:border-slate-700/50\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-xs font-bold text-slate-700 dark:text-slate-300\">\r\n                        Trade History ({isTestMode ? 'TEST' : 'LIVE'})\r\n                    </span>\r\n                    <span className=\"text-[10px] text-slate-500\">\r\n                        {trades.length} Closed\r\n                    </span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    {trades.length === 0 && <span className=\"text-[10px] text-slate-500 italic\">No closed trades</span>}\r\n                    <button onClick={onClose} className=\"text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white transition-colors\">\r\n                        <X size={14} />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"flex-1 overflow-auto custom-scrollbar\">\r\n                <table className=\"w-full border-collapse\">\r\n                    <thead className=\"bg-white dark:bg-slate-900 sticky top-0 z-20 text-[10px] text-slate-500 font-mono uppercase tracking-wider shadow-sm\">\r\n                        <tr>\r\n                            <th className=\"p-1 w-6\"></th>\r\n                            <th className=\"p-1 text-left\">Time</th>\r\n                            <th className=\"p-1 text-left\">Symbol</th>\r\n                            <th className=\"p-1 text-right\">Type</th>\r\n                            <th className=\"p-1 text-right\">Entry</th>\r\n                            <th className=\"p-1 text-right\">Exit</th>\r\n                            <th className=\"p-1 text-right\">Comm</th>\r\n                            <th className=\"p-1 text-right\">Swap</th>\r\n                            <th className=\"p-1 text-right\">Realized</th>\r\n                            <th className=\"p-1 w-8\"></th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"text-[11px] text-slate-600 dark:text-slate-300 font-mono\">\r\n                        {groupedTrades.map(group => (\r\n                            <React.Fragment key={group.date}>\r\n                                {/* Date Header */}\r\n                                <tr>\r\n                                    <td colSpan={10} className=\"bg-slate-100/80 dark:bg-slate-800/80 px-2 py-1 text-[10px] font-bold text-slate-600 dark:text-slate-400 uppercase tracking-wide border-b border-slate-200 dark:border-slate-800\">\r\n                                        {group.date}\r\n                                    </td>\r\n                                </tr>\r\n\r\n                                {group.trades.map(trade => (\r\n                                    <React.Fragment key={trade.tradeId}>\r\n                                        <tr className=\"border-b border-slate-200 dark:border-slate-800/50 hover:bg-slate-50 dark:hover:bg-slate-800/30 transition-colors\">\r\n                                            <td className=\"p-1 text-center cursor-pointer\" onClick={() => toggleExpand(trade.tradeId)}>\r\n                                                {expandedIds.has(trade.tradeId) ? <ChevronDown size={12} /> : <ChevronRight size={12} />}\r\n                                            </td>\r\n                                            <td className=\"p-1 text-slate-500 dark:text-slate-400\">\r\n                                                {/* Only Time displayed */}\r\n                                                <span className=\"text-slate-900 dark:text-white font-bold\">{trade.openTime ? new Date(trade.openTime).toLocaleTimeString() : '-'}</span>\r\n                                            </td>\r\n                                            <td className=\"p-1\">\r\n                                                <div className=\"flex items-center gap-1\">\r\n                                                    <span className=\"font-bold text-slate-900 dark:text-slate-200\">{trade.symbol}</span>\r\n                                                    <span className={`text-[9px] font-bold px-1 rounded ${trade.direction === 'BUY' ? 'bg-green-500/10 text-green-400' : 'bg-red-500/10 text-red-400'}`}>\r\n                                                        {trade.direction}\r\n                                                    </span>\r\n                                                </div>\r\n                                            </td>\r\n                                            <td className=\"p-1 text-right font-bold text-slate-900 dark:text-white\">Market</td>\r\n                                            <td className=\"p-1 text-right text-slate-900 dark:text-white\">{(trade as any).entryPrice || 0}</td>\r\n                                            <td className=\"p-1 text-right text-slate-900 dark:text-white\">{(trade as any).exitPrice || 0}</td>\r\n                                            <td className={`p-1 text-right font-bold ${(trade.commission || 0) < 0 ? 'text-red-600 dark:text-red-400' : 'text-slate-500 dark:text-slate-400'}`}>\r\n                                                {(trade.commission || 0).toFixed(2)}\r\n                                            </td>\r\n                                            <td className={`p-1 text-right font-bold ${(trade.swap || 0) < 0 ? 'text-red-600 dark:text-red-400' : 'text-slate-500 dark:text-slate-400'}`}>\r\n                                                {(trade.swap || 0).toFixed(2)}\r\n                                            </td>\r\n                                            <td className={`p-1 text-right font-bold ${Math.abs(trade.realizedPl || 0) < 0.005 ? 'text-slate-900 dark:text-white' : ((trade.realizedPl || 0) > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                                {(trade.realizedPl || 0).toFixed(2)}\r\n                                            </td>\r\n                                            <td className=\"p-1 text-center\">\r\n                                                <span className=\"text-[10px] text-slate-600\">CLOSED</span>\r\n                                            </td>\r\n                                        </tr>\r\n                                        {/* Child Rows */}\r\n                                        {expandedIds.has(trade.tradeId) && trade.positions.map(child => (\r\n                                            <tr key={child.id} className={`bg-slate-50 dark:bg-slate-900/80 border-b border-slate-200 dark:border-slate-800/30 text-[10px] text-slate-500 ${child.status === 'OFFLINE' ? 'opacity-40 grayscale' : ''}`}>\r\n                                                <td className=\"p-1\"></td>\r\n                                                <td className=\"p-1 pl-4 flex items-center gap-1\">\r\n                                                    <span className=\"w-1.5 h-1.5 rounded-full bg-slate-600\"></span>\r\n                                                    {child.botId}\r\n                                                </td>\r\n                                                <td className=\"p-1 text-left\">{child.brokerId}</td>\r\n                                                <td className=\"p-1 text-right\">{trade.direction}</td>\r\n                                                <td className=\"p-1 text-right\">{child.entryPrice?.toFixed(5)}</td>\r\n                                                <td className=\"p-1 text-right\">{child.currentPrice?.toFixed(5)}</td>\r\n                                                <td className=\"p-1 text-right\">{(child.commission || 0).toFixed(2)}</td>\r\n                                                <td className=\"p-1 text-right\">{(child.swap || 0).toFixed(2)}</td>\r\n                                                <td className=\"p-1 text-right font-mono text-slate-400\">{(child.realizedPl || 0).toFixed(2)}</td>\r\n                                                <td className=\"p-1 text-center text-[9px]\">\r\n                                                    {child.status === 'OFFLINE' ? (\r\n                                                        <span className=\"text-slate-500 border border-slate-300 dark:border-slate-700 px-1 rounded-[2px]\">OFFLINE</span>\r\n                                                    ) : (\r\n                                                        child.status\r\n                                                    )}\r\n                                                </td>\r\n                                            </tr>\r\n                                        ))}\r\n                                    </React.Fragment>\r\n                                ))}\r\n                            </React.Fragment>\r\n                        ))}\r\n                        {trades.length === 0 && !isLoading && (\r\n                            <tr>\r\n                                <td colSpan={10} className=\"p-8 text-center text-slate-500 italic\">\r\n                                    No closed trades found for {isTestMode ? 'TEST' : 'LIVE'} environment.\r\n                                </td>\r\n                            </tr>\r\n                        )}\r\n                    </tbody>\r\n                    <tfoot className=\"bg-slate-50 dark:bg-slate-900 text-[11px] font-mono font-bold text-slate-700 dark:text-slate-300 sticky bottom-0 z-10 shadow-[0_-1px_0_theme(colors.slate.300)] dark:shadow-[0_-1px_0_theme(colors.slate.700)]\">\r\n                        {(() => {\r\n                            const totals = trades.reduce((acc, t) => ({\r\n                                comm: acc.comm + (t.commission || 0),\r\n                                swap: acc.swap + (t.swap || 0),\r\n                                realized: acc.realized + (t.realizedPl || 0)\r\n                            }), { comm: 0, swap: 0, realized: 0 });\r\n\r\n                            return (\r\n                                <tr>\r\n                                    <td className=\"p-2\"></td>\r\n                                    <td className=\"p-2 text-slate-500 uppercase tracking-wider text-[10px]\">Total</td>\r\n                                    <td className=\"p-2\"></td>\r\n                                    <td className=\"p-2\"></td>\r\n                                    <td className=\"p-2\"></td>\r\n                                    <td className=\"p-2\"></td>\r\n\r\n                                    {/* Comm */}\r\n                                    <td className={`p-2 text-right ${Math.abs(totals.comm) < 0.005 ? 'text-slate-500' : (totals.comm > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                        {totals.comm.toFixed(2)}\r\n                                    </td>\r\n\r\n                                    {/* Swap */}\r\n                                    <td className={`p-2 text-right ${Math.abs(totals.swap) < 0.005 ? 'text-slate-500' : (totals.swap > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                        {totals.swap.toFixed(2)}\r\n                                    </td>\r\n\r\n                                    {/* Realized */}\r\n                                    <td className={`p-2 text-right ${Math.abs(totals.realized) < 0.005 ? 'text-slate-500' : (totals.realized > 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400')}`}>\r\n                                        {totals.realized.toFixed(2)}\r\n                                    </td>\r\n\r\n                                    <td className=\"p-2\"></td>\r\n                                </tr>\r\n                            );\r\n                        })()}\r\n                    </tfoot>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n"],"names":[],"mappings":"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"}}]
}